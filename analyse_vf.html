<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analyse_vf</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="analyse_vf_files/libs/clipboard/clipboard.min.js"></script>
<script src="analyse_vf_files/libs/quarto-html/quarto.js"></script>
<script src="analyse_vf_files/libs/quarto-html/popper.min.js"></script>
<script src="analyse_vf_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="analyse_vf_files/libs/quarto-html/anchor.min.js"></script>
<link href="analyse_vf_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="analyse_vf_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="analyse_vf_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="analyse_vf_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="analyse_vf_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analyse_vf</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Introduction : Présentation du modèle conceptuel</p>
<p>Les résultats présentés ci-après sont tirés des travaux de la thèse de doctorat de Yoann Ducoux. L’objectif de l’étude quantitative menée est d’améliorer la compréhension de la structure cognitive qui permet aux candidats de passer de l’observation d’informations à propos d’un employeur à un sentiment favorable envers cet employeur. Par extension, cette étude aide les entreprises à favoriser les chances de réussite du processus de recrutement.</p>
<p>En vertu de la théorie des signaux (Spence, 1973; Stiglitz, 1975) et de son extension la théorie de la signalisation par les tierces parties de la marque employeur (Dineen et al.,2019) nous souhaitons démontrer le rôle central de la crédibilité dans la création de l’image employeur chez le candidat. L’étude présente donc en guise d’informations des signaux, c’est-à-dire des informations qui ne permettent pas au candidat de juger de la qualité de l’entreprise sur la base de ses préférences individuelles mais uniquement à travers la confiance qu’il peut avoir sur le fait que l’entreprise se révelera un employeur satisfaisant au regard de ses propres attentes.</p>
<p>Pour collecter les données, nous avons créé un stimuli qui présente la page carrière d’une entreprise fictive ABCompany. Le stimuli comporte deux variables : la note Glassdoor qui dispose de trois modalités (bonne/neutre/mauvaise) et une enquête de satisfaction des employés de l’entreprise dont la source prend deux modalités (interne/externe). Chaque répondant a donc été exposé à l’un des six scénarios comportant une combinaison de la Note Glassdoor et de la Source de l’enquête de satisfaction.</p>
<p>Les variables qui composent le modèle sont :</p>
<ul>
<li><p>La Note Glassdoor de l’employeur fictif ABCompany qui varie entre 2,5/5 3,5/5 et 4,5/5.</p></li>
<li><p>La Source de l’enquête de satisfaction des employés de l’entreprise ABCompany.</p></li>
<li><p>La congruence des signaux (Note Glassdoor et enquête de satisfaction)</p></li>
<li><p>La crédibilité des signaux, c’est-à-dire la crédibilité de la Note Glassdoor et la crédibilité de l’enquête de satisfaction</p></li>
<li><p>La crédibilité de la marque employeur de l’entreprise ABCompany</p></li>
<li><p>L’image employeur de l’entreprise ABCompany</p></li>
<li><p>Et deux variables de contrôle : l’âge des répondants et la familiarité avec l’entreprise ABC, c’est-à-dire l’impression de connaitre l’entreprise avant d’avoir vu les signaux que nous leur présentons.</p></li>
</ul>
<p>NB : En raison d’un erreur du questionnaire Qualtrics, les réponses des répondants du scénario 1 pour l’échelle de mesure de l’une des variables du modèle (CredE) n’ont pas été enregistrées. Nous avons donc fait une seconde collecte complémentaire, uniquement pour le scénario 1, qui a ensuite servi à imputer les données manquantes de la première collecte. La procédure d’imputation est expliquée dans le document.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/conceptual_diagram-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<section id="hypothèses-de-recherche" class="level2">
<h2 class="anchored" data-anchor-id="hypothèses-de-recherche">Hypothèses de recherche</h2>
<p>Sur la base de notre cadre conceptuel, nous formulons les hypothèses suivantes concernant les relations entre la note d’employeur, sa source, et l’image employeur de l’entreprise:</p>
<section id="relations-directes" class="level3">
<h3 class="anchored" data-anchor-id="relations-directes">Relations directes</h3>
<p><strong>H1</strong>: La note Glassdoor de l’employeur (Note) influence positivement l’image employeur (Image).</p>
<p><strong>H2</strong>: La note Glassdoor de l’employeur (Note) influence positivement la congruence des signaux (Cong).</p>
<p><strong>H3</strong>: La source de l’enquête (Source) influence positivement la congruence des signaux (Cong).</p>
<p><strong>H4</strong>: La note Glassdoor de l’employeur (Note) influence la crédibilité perçue de la note Glassdoor de l’employeur (CredGD).</p>
<p><strong>H5</strong>: La source de l’enquête (Source) influence la crédibilité perçue de l’enquête (CredE).</p>
<p><strong>H6</strong>: La congruence des signaux (Cong) influence positivement la crédibilité des signaux. - H6a: La congruence des signaux (Cong) influence positivement crédibilité de l’enquête (CredE). - H6b: La congruence des signaux (Cong) influence positivement crédibilité de la note Glassdoor (CredGD).</p>
<p><strong>H7</strong>: La crédibilité de la marque employeur (CredME) influence positivement l’image employeur (Image).</p>
<p><strong>H8</strong>: La crédibilité des signaux influence la crédibilité de la marque employeur(CredME). - H8a: La crédibilité de la note Glassdoor (CredGD) influence positivement crédibilité de la marque employeur (CredME). - H8b: La crédibilité de l’enquête (CredE) influence positvement crédibilité de la marque employeur (CredME).</p>
</section>
<section id="médiations" class="level3">
<h3 class="anchored" data-anchor-id="médiations">Médiations</h3>
<p><strong>H9</strong>: Les effets de la source de l’enquête sur l’image employeur sont médiatisés par une chaîne de médiation (médiation séquentielle) impliquant dans l’ordre la congruence des signaux, la crédibilité des signaux et la crédibilité de la marque employeur. - H9a: La séquence de médiateurs congruence des signaux, crédibilité de la note Glassdoor, crédibilité de la marque employeur médiatise la relation entre la source de l’enquête et l’image employeur. - H9b: La séquence de médiateurs congruence des signaux, crédibilité de l’enquête, crédibilité de la marque employeur médiatise la relation entre la source de l’enquête et l’image employeur.</p>
<p><strong>H10</strong>: Les effets de la source de l’enquête sur l’image employeur sont médiatisés par une chaîne de médiation (médiation séquentielle) impliquant dans l’ordre la crédibilité de l’enquête et la crédibilité de la marque employeur.</p>
<p><strong>H11</strong>: Les effets de la note Glassdoor sur l’image employeur sont médiatisés par une chaîne de médiation (médiation séquentielle) impliquant dans l’ordre la crédibilité de la note Glassdoor et la crédibilité de la marque employeur.</p>
<p><strong>H12</strong>: Les effets de la note sur l’image employeur sont médiatisés par une chaîne de médiation (médiation séquentielle) impliquant dans l’ordre la congruence des signaux, la crédibilité des signaux et la crédibilité de la marque employeur. - H12a: La séquence de médiateurs congruence des signaux, crédibilité de la note Glassdoor, crédibilité de la marque employeur médiatise la relation entre la note Glassdoor et l’image employeur. - H12b: La séquence de médiateurs congruence des signaux, crédibilité de l’enquête, crédibilité de la marque employeur médiatise la relation entre la note Glassdoor et l’image employeur.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mitools)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjlabelled)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Importation des données</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>collecte_1 <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">"data/collecte_1.sav"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>collecte_2 <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">"data/collecte_2.sav"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fusion des données</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(collecte_1, collecte_2)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion des variables labellisées en types R standard</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">zap_labels</span>(merged_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="nettoyage-et-préparation-des-données" class="level1">
<h1>2. Nettoyage et préparation des données</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Filtrage sur la complétion</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Progress <span class="sc">==</span> <span class="dv">100</span>)           <span class="co"># Progression complète</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Exclusion des temps aberrants</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>q_lower <span class="ot">&lt;-</span> <span class="fu">quantile</span>(merged_df<span class="sc">$</span>Duration__in_seconds_, <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>q_upper <span class="ot">&lt;-</span> <span class="fu">quantile</span>(merged_df<span class="sc">$</span>Duration__in_seconds_, <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(merged_df,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  Duration__in_seconds_ <span class="sc">&gt;=</span> q_lower <span class="sc">&amp;</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  Duration__in_seconds_ <span class="sc">&lt;=</span> q_upper)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Filtrage sur le check d'attention</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Informations_site_5 <span class="sc">==</span> <span class="dv">6</span>)  <span class="co"># Check d'attention</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Création des variables scénario, Note et Source</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">scenario =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(A25_baro_chrono_Page_Submit)   <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(A25extchrono_Page_Submit)      <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(A35baro_chrono_Page_Submit)    <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(A35extchrono_Page_Submit)      <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(A45_baro_chrono_Page_Submit)   <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(A45extchrono_Page_Submit)      <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>                                  <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Note =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="fl">2.5</span>,  <span class="co"># Codé comme 1</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>) <span class="sc">~</span> <span class="fl">3.5</span>,  <span class="co"># Codé comme 2</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>) <span class="sc">~</span> <span class="fl">4.5</span>,  <span class="co"># Codé comme 3</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>                  <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Source =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>                     <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Conversion en numérique de toutes les variables</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="fu">starts_with</span>(<span class="st">"congruence_signaux_"</span>),</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>             <span class="fu">starts_with</span>(<span class="st">"Cr_dibilit__ABC_"</span>),</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>             <span class="fu">starts_with</span>(<span class="st">"Cr_dibilit__GD_"</span>),</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>             <span class="fu">starts_with</span>(<span class="st">"Image_employeur_"</span>),</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>             <span class="fu">starts_with</span>(<span class="st">"Familiarit__ABC_"</span>),</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>             <span class="fu">starts_with</span>(<span class="st">"Cr_dibilit__baro_"</span>),</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>             <span class="fu">starts_with</span>(<span class="st">"cr_dibilit__baro_ext_"</span>),</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>             age, genre), as_numeric)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Recodage de congruence_signaux_3 (item inversé)</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">congruence_signaux_3 =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>      congruence_signaux_3 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span> <span class="sc">~</span> <span class="dv">8</span> <span class="sc">-</span> congruence_signaux_3,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> congruence_signaux_3</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Création de age_num</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>merged_df<span class="sc">$</span>age_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"[^0-9]"</span>, <span class="st">""</span>, merged_df<span class="sc">$</span>age))</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Création des scores composites (sauf CredE qui sera créé après imputation)</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cong =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"congruence_signaux_"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">CredME =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Cr_dibilit__ABC_"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">CredGD =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Cr_dibilit__GD_"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">Image =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Image_employeur_"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">FAM =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Familiarit__ABC_"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Variables à conserver pour l'analyse finale</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>vars_to_keep <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables de base</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Note"</span>, <span class="st">"Source"</span>, <span class="st">"scenario"</span>, </span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scores composites</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cong"</span>, <span class="st">"CredGD"</span>, <span class="st">"CredME"</span>, <span class="st">"Image"</span>, <span class="st">"FAM"</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables de contrôle</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">"genre"</span>, <span class="st">"age_num"</span>,</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Items de crédibilité pour imputation</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cr_dibilit__baro_int_1"</span>, <span class="st">"Cr_dibilit__baro_int_2"</span>, </span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cr_dibilit__baro_int_3"</span>, <span class="st">"Cr_dibilit__baro_int_4"</span>,</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cr_dibilit__baro_ext_1"</span>, <span class="st">"cr_dibilit__baro_ext_2"</span>,</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cr_dibilit__baro_ext_3"</span>, <span class="st">"cr_dibilit__baro_ext_4"</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. Préparation des sous-ensembles pour l'imputation</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Données pour la fusion (scénarios 2 à 6)</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>subset_for_merging <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scenario <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(vars_to_keep))</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Données complètes (tous scénarios, sans données manquantes)</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>subset_noDM <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    scenario <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">|</span> </span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    (scenario <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Cr_dibilit__baro_int_1))</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(vars_to_keep))</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables à imputer spécifiquement pour le scénario 1</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>vars_to_impute <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables de base</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Note"</span>, <span class="st">"Source"</span>, <span class="st">"scenario"</span>, </span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scores composites</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cong"</span>, <span class="st">"CredGD"</span>, <span class="st">"CredME"</span>, <span class="st">"Image"</span>, <span class="st">"FAM"</span>,</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables de contrôle</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>    <span class="st">"genre"</span>, <span class="st">"age_num"</span>,</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Uniquement les items de crédibilité interne (pertinents pour scénario 1)</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cr_dibilit__baro_int_1"</span>, <span class="st">"Cr_dibilit__baro_int_2"</span>, </span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cr_dibilit__baro_int_3"</span>, <span class="st">"Cr_dibilit__baro_int_4"</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Données du scénario 1 pour imputation</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>subset_scenario1 <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scenario <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(vars_to_impute))</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion des variables labellisées en types R standard</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>subset_scenario1 <span class="ot">&lt;-</span> subset_scenario1 <span class="sc">%&gt;%</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="cf">function</span>(x) {</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">inherits</span>(x, <span class="st">"haven_labelled"</span>)) {</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">as.numeric</span>(x))</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x)</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>  }))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="imputation-multiple-et-règle-de-rubin" class="level2">
<h2 class="anchored" data-anchor-id="imputation-multiple-et-règle-de-rubin">Imputation multiple et règle de Rubin</h2>
<p>L’imputation multiple est une méthode statistique robuste pour traiter les données manquantes. Contrairement à l’imputation simple qui remplace chaque valeur manquante par une seule estimation, l’imputation multiple crée plusieurs jeux de données complets (généralement entre 5 et 20) où les valeurs manquantes sont remplacées par différentes estimations plausibles. Cette approche permet de capturer l’incertitude liée à l’imputation.</p>
<p>Dans notre étude, nous utilisons deux méthodes d’imputation différentes :</p>
<ol type="1">
<li><p><strong>Predictive Mean Matching (PMM)</strong> : Cette méthode impute les valeurs manquantes en utilisant des valeurs observées provenant d’autres observations ayant des caractéristiques similaires. Elle préserve la distribution des données observées et est particulièrement adaptée aux variables continues.</p></li>
<li><p><strong>Random Forest (RF)</strong> : Cette méthode utilise des algorithmes d’apprentissage automatique pour prédire les valeurs manquantes en fonction des relations complexes entre les variables. Elle est capable de capturer des relations non linéaires et des interactions.</p></li>
</ol>
<p>Pour combiner les résultats des analyses effectuées sur chaque jeu de données imputé, nous appliquons la <strong>règle de Rubin</strong> (1987), qui permet d’obtenir des estimations non biaisées des paramètres et de leurs erreurs standard. Cette règle stipule que :</p>
<ul>
<li>L’estimation combinée d’un paramètre est la moyenne des estimations obtenues sur chaque jeu imputé.</li>
<li>La variance totale associée à cette estimation est la somme de deux composantes :
<ol type="1">
<li>La variance intra-imputation (moyenne des variances estimées dans chaque jeu)</li>
<li>La variance inter-imputation (variance des estimations entre les jeux), multipliée par un facteur d’ajustement (1 + 1/m, où m est le nombre d’imputations)</li>
</ol></li>
</ul>
<p>Cette approche nous permet d’obtenir des résultats plus fiables en tenant compte à la fois de l’incertitude liée à l’échantillonnage et de celle liée à l’imputation des données manquantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. Configuration pour l'imputation</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Image"</span>, <span class="st">"Cong"</span>, <span class="st">"CredME"</span>, <span class="st">"CredGD"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 12. Imputation</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># PMM</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>imp_pmm <span class="ot">&lt;-</span> <span class="fu">mice</span>(subset_scenario1, <span class="at">m =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"pmm"</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">predictorMatrix =</span> <span class="fu">quickpred</span>(subset_scenario1, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">include =</span> predictors),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># RF</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>imp_rf <span class="ot">&lt;-</span> <span class="fu">mice</span>(subset_scenario1, <span class="at">m =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">predictorMatrix =</span> <span class="fu">quickpred</span>(subset_scenario1, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">include =</span> predictors),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 13. Création des jeux de données finaux avec fusion des items de crédibilité</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>create_final_datasets <span class="ot">&lt;-</span> <span class="cf">function</span>(imp, subset_for_merging) {</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  datasets <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, imp<span class="sc">$</span>m)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imp<span class="sc">$</span>m) {</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Récupération des données imputées du scénario 1</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    imputed_data <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp, <span class="at">action =</span> i)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fusion avec les autres scénarios</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(imputed_data, subset_for_merging) <span class="sc">%&gt;%</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(scenario)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Création des variables CredE fusionnées</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    combined_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">CredE1 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>          Source <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Cr_dibilit__baro_int_1,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>          Source <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> cr_dibilit__baro_ext_1</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">CredE2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>          Source <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Cr_dibilit__baro_int_2,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>          Source <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> cr_dibilit__baro_ext_2</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">CredE3 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>          Source <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Cr_dibilit__baro_int_3,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>          Source <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> cr_dibilit__baro_ext_3</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">CredE4 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>          Source <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Cr_dibilit__baro_int_4,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>          Source <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> cr_dibilit__baro_ext_4</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">CredE =</span> <span class="fu">rowMeans</span>(<span class="fu">cbind</span>(CredE1, CredE2, CredE3, CredE4), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    datasets[[i]] <span class="ot">&lt;-</span> combined_data</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(datasets)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Création des trois jeux de données finaux</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>subset_pmm <span class="ot">&lt;-</span> <span class="fu">create_final_datasets</span>(imp_pmm, subset_for_merging)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>subset_rf <span class="ot">&lt;-</span> <span class="fu">create_final_datasets</span>(imp_rf, subset_for_merging)</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Application de la même logique aux données complètes</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>subset_noDM <span class="ot">&lt;-</span> subset_noDM <span class="sc">%&gt;%</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">CredE1 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>      Source <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Cr_dibilit__baro_int_1,</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>      Source <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> cr_dibilit__baro_ext_1</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">CredE2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>      Source <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Cr_dibilit__baro_int_2,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>      Source <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> cr_dibilit__baro_ext_2</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">CredE3 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>      Source <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Cr_dibilit__baro_int_3,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>      Source <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> cr_dibilit__baro_ext_3</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">CredE4 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>      Source <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Cr_dibilit__baro_int_4,</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>      Source <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> cr_dibilit__baro_ext_4</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">CredE =</span> <span class="fu">rowMeans</span>(<span class="fu">cbind</span>(CredE1, CredE2, CredE3, CredE4), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="co"># 14. Vérification des données manquantes dans chaque jeu</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>check_missing <span class="ot">&lt;-</span> <span class="cf">function</span>(data, name) {</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Vérification des valeurs manquantes dans"</span>, name, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">sapply</span>(data, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x))))</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="fu">check_missing</span>(subset_noDM, <span class="st">"subset_noDM"</span>)</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="fu">check_missing</span>(subset_pmm[[<span class="dv">1</span>]], <span class="st">"premier jeu PMM"</span>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="fu">check_missing</span>(subset_rf[[<span class="dv">1</span>]], <span class="st">"premier jeu RF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#Procédure de vérification</p>
</section>
<section id="vérification-des-manipulations-expérimentales" class="level2">
<h2 class="anchored" data-anchor-id="vérification-des-manipulations-expérimentales">Vérification des manipulations expérimentales</h2>
<p>Avant de procéder aux analyses principales, nous vérifions l’efficacité des manipulations expérimentales entre les différents scénarios. Ces analyses ANOVA nous permettent de confirmer que les participants ont bien perçu les différences entre les conditions expérimentales, notamment concernant les informations présentées sur Glassdoor et sur le site de l’entreprise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des items à vérifier</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>items_check <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Info_Glassdoor_1"</span>, <span class="st">"Info_Glassdoor_2"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Info_Glassdoor_3"</span>, <span class="st">"Info_Glassdoor_4"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Informations_site_1"</span>, <span class="st">"Informations_site_2"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Informations_site_3"</span>, <span class="st">"Informations_site_4"</span>, <span class="st">"Informations_site_5"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse ANOVA pour chaque item par scénario</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (item <span class="cf">in</span> items_check) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== ANOVA for"</span>, item, <span class="st">"by scenario ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  frm <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(item, <span class="st">"~ factor(scenario)"</span>))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(frm, <span class="at">data=</span>merged_df)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(mod))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interprétation-des-résultats-des-anovas" class="level3">
<h3 class="anchored" data-anchor-id="interprétation-des-résultats-des-anovas">Interprétation des résultats des ANOVAs</h3>
<p>L’analyse des résultats des ANOVAs nous permet d’évaluer systématiquement l’efficacité de nos manipulations expérimentales à travers les différents scénarios :</p>
<section id="manipulation-de-la-note-et-source-dévaluation-glassdoor" class="level4">
<h4 class="anchored" data-anchor-id="manipulation-de-la-note-et-source-dévaluation-glassdoor">Manipulation de la note et source d’évaluation (Glassdoor)</h4>
<ol type="1">
<li><strong>Info_Glassdoor_1</strong> - <em>“La note sur l’employeur ABCompany qui apparaît sur son site carrière émane de Glassdoor”</em>
<ul>
<li>Non significatif : F(5,399) = 1.695, p = 0.135</li>
<li>La reconnaissance de Glassdoor comme source est similaire dans tous les scénarios, suggérant une attribution claire de la source indépendamment des conditions expérimentales.</li>
</ul></li>
<li><strong>Info_Glassdoor_2</strong> - <em>“Le résultat de cette évaluation est indépendant de l’entreprise ABCompany”</em>
<ul>
<li>Non significatif : F(5,399) = 1.449, p = 0.206</li>
<li>La perception d’indépendance de l’évaluation reste constante à travers les scénarios, confirmant l’uniformité de cette dimension dans notre dispositif expérimental.</li>
</ul></li>
<li><strong>Info_Glassdoor_3</strong> - <em>“D’après les informations de Glassdoor, l’entreprise ABCompany est un bon employeur”</em>
<ul>
<li>Très significatif : F(5,399) = 76.96, p &lt; 0.001</li>
<li>Cette différence hautement significative confirme que notre manipulation de la note (2.5, 3.5, 4.5) a été correctement perçue par les participants, validant le succès de cette manipulation cruciale.</li>
</ul></li>
<li><strong>Info_Glassdoor_4</strong> - <em>“D’après les informations de Glassdoor, les employés de ABC recommandent de travailler pour cet employeur”</em>
<ul>
<li>Très significatif : F(5,399) = 35.29, p &lt; 0.001</li>
<li>Cette différence significative renforce la confirmation de l’efficacité de notre manipulation des évaluations, montrant que les participants perçoivent des niveaux différents de recommandation selon les scénarios.</li>
</ul></li>
</ol>
</section>
<section id="perception-du-site-carrière" class="level4">
<h4 class="anchored" data-anchor-id="perception-du-site-carrière">Perception du site carrière</h4>
<ol type="1">
<li><strong>Informations_site_1</strong> - <em>“L’entreprise ABCompany est à l’origine de ce site internet”</em>
<ul>
<li>Non significatif : F(5,399) = 0.947, p = 0.451</li>
<li>La perception de l’entreprise comme source du site reste constante entre les scénarios, assurant une base homogène pour l’interprétation des autres variables.</li>
</ul></li>
<li><strong>Informations_site_2</strong> - <em>“Le site que j’ai vu est le site carrière de l’entreprise ABCompany”</em>
<ul>
<li>Non significatif : F(5,399) = 0.494, p = 0.781</li>
<li>L’identification uniforme du site comme site carrière à travers les scénarios assure la cohérence de notre environnement expérimental.</li>
</ul></li>
<li><strong>Informations_site_3</strong> - <em>“Ce site carrière fait apparaître un taux de recommandation de l’entreprise ABCompany comme employeur”</em>
<ul>
<li>Non significatif : F(5,399) = 1.184, p = 0.316</li>
<li>La visibilité perçue du taux de recommandation est constante entre les scénarios, confirmant la standardisation de cet élément dans notre design.</li>
</ul></li>
<li><strong>Informations_site_4</strong> - <em>“Ce site carrière fait apparaître une note sur ABCompany comme employeur”</em>
<ul>
<li>Non significatif : F(5,399) = 1.659, p = 0.144</li>
<li>La perception de la présence d’une note est homogène à travers les différentes conditions, soutenant la cohérence de notre présentation expérimentale.</li>
</ul></li>
<li><strong>Informations_site_5</strong> - <em>Check d’attention</em>
<ul>
<li>Non significatif : F(5,399) = 1.364, p = 0.237</li>
<li>Cette homogénéité est attendue pour un item de vérification d’attention, confirmant la fiabilité de notre filtre d’inclusion des participants.</li>
</ul></li>
</ol>
<p>Cette analyse systématique révèle que nos manipulations expérimentales ont fonctionné comme prévu. Spécifiquement, les différences significatives observées pour les items 3 et 4 de Glassdoor confirment que la manipulation de la note de l’employeur a été efficacement perçue, tandis que l’homogénéité des autres perceptions atteste de la standardisation appropriée des éléments non manipulés. Ces vérifications valident la robustesse de notre design expérimental et renforcent la fiabilité des analyses subséquentes.</p>
<p>Ces vérifications confirment que nos manipulations expérimentales ont fonctionné comme prévu, ce qui nous permet de procéder avec confiance aux analyses psychométriques et structurelles suivantes.</p>
</section>
</section>
</section>
</section>
<section id="analyses-psychométriques" class="level1">
<h1>3. Analyses psychométriques</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction pour les analyses psychométriques complètes</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>analyse_psychometrique <span class="ot">&lt;-</span> <span class="cf">function</span>(data, nom_echelle, items) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Analyse psychométrique de"</span>, nom_echelle, <span class="st">"===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extraction des données de l'échelle</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  data_echelle <span class="ot">&lt;-</span> data[, items, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  complete_cases <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(data_echelle)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  data_complete <span class="ot">&lt;-</span> data_echelle[complete_cases, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Statistiques descriptives</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">1. Statistiques descriptives :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(data_echelle))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Tests de normalité et adéquation</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">2. Tests de normalité et adéquation :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># KMO</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    mat_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_complete)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    kmo <span class="ot">&lt;-</span> <span class="fu">KMO</span>(mat_cor)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"- KMO ="</span>, <span class="fu">round</span>(kmo<span class="sc">$</span>MSA, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test de Bartlett</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_complete)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    bartlett <span class="ot">&lt;-</span> <span class="fu">cortest.bartlett</span>(mat_cor, <span class="at">n =</span> n)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"- Test de Bartlett : chi2 ="</span>, <span class="fu">round</span>(bartlett<span class="sc">$</span>chisq, <span class="dv">2</span>),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">", ddl ="</span>, bartlett<span class="sc">$</span>df,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">", p ="</span>, <span class="fu">format.pval</span>(bartlett<span class="sc">$</span>p.value), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Impossible de calculer KMO/Bartlett:"</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Fiabilité (Alpha de Cronbach)</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">3. Fiabilité :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    alpha_res <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(data_echelle)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Alpha de Cronbach = %.3f</span><span class="sc">\n</span><span class="st">"</span>, alpha_res<span class="sc">$</span>total<span class="sc">$</span>raw_alpha))</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statistiques par item si supprimé :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">round</span>(alpha_res<span class="sc">$</span>alpha.drop, <span class="dv">3</span>))</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Corrélations item-total :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">round</span>(alpha_res<span class="sc">$</span>item.stats, <span class="dv">3</span>))</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"- Impossible de calculer l'alpha de Cronbach:"</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    alpha_res <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">total =</span> <span class="fu">list</span>(<span class="at">raw_alpha =</span> <span class="cn">NA</span>))</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4. Analyse factorielle</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">4. Analyse factorielle :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">sum</span>(complete_cases) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Test du nombre de facteurs</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>      nfactors <span class="ot">&lt;-</span> <span class="fu">fa.parallel</span>(data_complete, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">fm =</span> <span class="st">"ml"</span>)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Nombre de facteurs suggéré :"</span>, nfactors<span class="sc">$</span>nfact, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Analyse factorielle</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>      fa_res <span class="ot">&lt;-</span> <span class="fu">fa</span>(data_complete, <span class="at">nfactors =</span> <span class="dv">1</span>, <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">- Loadings :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">round</span>(fa_res<span class="sc">$</span>loadings, <span class="dv">3</span>))</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">- Communalités :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">round</span>(fa_res<span class="sc">$</span>communality, <span class="dv">3</span>))</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">- Variance expliquée : %.2f%%</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>                fa_res<span class="sc">$</span>Vaccounted[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Résidus</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">- Résidus :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>      residuals <span class="ot">&lt;-</span> <span class="fu">factor.residuals</span>(mat_cor, fa_res<span class="sc">$</span>loadings)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"RMSR ="</span>, <span class="fu">sqrt</span>(<span class="fu">mean</span>(residuals[<span class="fu">lower.tri</span>(residuals)]<span class="sc">^</span><span class="dv">2</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Pas assez de données complètes pour l'analyse factorielle</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>      fa_res <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Erreur dans l'analyse factorielle:"</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    fa_res <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">normalite =</span> <span class="fu">list</span>(<span class="at">shapiro =</span> <span class="cn">NA</span>,</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skew =</span> <span class="fu">sapply</span>(data_echelle, skew),</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>                    <span class="at">kurtosis =</span> <span class="fu">sapply</span>(data_echelle, kurtosi)),</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">kmo =</span> <span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"kmo"</span>)) kmo<span class="sc">$</span>MSA <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">bartlett =</span> <span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"bartlett"</span>)) bartlett <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_res<span class="sc">$</span>total<span class="sc">$</span>raw_alpha,</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">fa =</span> fa_res</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyses psychométriques pour les échelles avec items dans merged_df</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="co"># CredGD</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>items_CredGD <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Cr_dibilit__GD_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>analyse_CredGD <span class="ot">&lt;-</span> <span class="fu">analyse_psychometrique</span>(merged_df, <span class="st">"CredGD"</span>, items_CredGD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyse psychométrique de CredGD ===

1. Statistiques descriptives :
 Cr_dibilit__GD_1 Cr_dibilit__GD_2 Cr_dibilit__GD_3 Cr_dibilit__GD_4
 Min.   :1.000    Min.   :1.000    Min.   :1.000    Min.   :1.000   
 1st Qu.:3.000    1st Qu.:3.000    1st Qu.:4.000    1st Qu.:4.000   
 Median :4.000    Median :4.000    Median :4.000    Median :4.000   
 Mean   :3.951    Mean   :3.765    Mean   :4.247    Mean   :4.178   
 3rd Qu.:5.000    3rd Qu.:4.000    3rd Qu.:5.000    3rd Qu.:5.000   
 Max.   :7.000    Max.   :7.000    Max.   :7.000    Max.   :7.000   

2. Tests de normalité et adéquation :
- KMO = 0.599 
- Test de Bartlett : chi2 = 189.51 , ddl = 6 , p = &lt; 2.22e-16 

3. Fiabilité :
- Alpha de Cronbach = 0.563

Statistiques par item si supprimé :
                 raw_alpha std.alpha G6(smc) average_r   S/N alpha se var.r
Cr_dibilit__GD_1     0.533     0.565   0.503     0.302 1.298    0.041 0.031
Cr_dibilit__GD_2     0.526     0.579   0.502     0.315 1.377    0.040 0.021
Cr_dibilit__GD_3     0.436     0.436   0.346     0.205 0.774    0.047 0.004
Cr_dibilit__GD_4     0.483     0.506   0.408     0.255 1.026    0.043 0.001
                 med.r
Cr_dibilit__GD_1 0.294
Cr_dibilit__GD_2 0.238
Cr_dibilit__GD_3 0.238
Cr_dibilit__GD_4 0.248

Corrélations item-total :
                   n raw.r std.r r.cor r.drop  mean    sd
Cr_dibilit__GD_1 405 0.720 0.636 0.409  0.327 3.951 1.520
Cr_dibilit__GD_2 405 0.645 0.621 0.397  0.306 3.765 1.265
Cr_dibilit__GD_3 405 0.669 0.744 0.645  0.456 4.247 0.914
Cr_dibilit__GD_4 405 0.630 0.688 0.551  0.366 4.178 1.028

4. Analyse factorielle :</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/analyses_psychometriques-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  3  and the number of components =  NA 

Nombre de facteurs suggéré : 3 

- Loadings :

Loadings:
                 ML1  
Cr_dibilit__GD_1 0.337
Cr_dibilit__GD_2 0.355
Cr_dibilit__GD_3 0.785
Cr_dibilit__GD_4 0.602

                 ML1
SS loadings    1.218
Proportion Var 0.305

- Communalités :
Cr_dibilit__GD_1 Cr_dibilit__GD_2 Cr_dibilit__GD_3 Cr_dibilit__GD_4 
           0.114            0.126            0.616            0.362 

- Variance expliquée : 30.46%

- Résidus :
RMSR = 0.06691895 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CredME</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>items_CredME <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Cr_dibilit__ABC_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>analyse_CredME <span class="ot">&lt;-</span> <span class="fu">analyse_psychometrique</span>(merged_df, <span class="st">"CredME"</span>, items_CredME)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyse psychométrique de CredME ===

1. Statistiques descriptives :
 Cr_dibilit__ABC_1 Cr_dibilit__ABC_2 Cr_dibilit__ABC_3
 Min.   :1.000     Min.   :1.000     Min.   :1.000    
 1st Qu.:3.000     1st Qu.:4.000     1st Qu.:3.000    
 Median :4.000     Median :4.000     Median :4.000    
 Mean   :4.025     Mean   :3.988     Mean   :3.886    
 3rd Qu.:5.000     3rd Qu.:4.000     3rd Qu.:4.000    
 Max.   :7.000     Max.   :7.000     Max.   :7.000    

2. Tests de normalité et adéquation :
- KMO = 0.723 
- Test de Bartlett : chi2 = 580.68 , ddl = 3 , p = &lt; 2.22e-16 

3. Fiabilité :
- Alpha de Cronbach = 0.859

Statistiques par item si supprimé :
                  raw_alpha std.alpha G6(smc) average_r   S/N alpha se var.r
Cr_dibilit__ABC_1     0.847     0.848   0.736     0.736 5.587    0.015    NA
Cr_dibilit__ABC_2     0.800     0.802   0.670     0.670 4.051    0.020    NA
Cr_dibilit__ABC_3     0.761     0.767   0.622     0.622 3.286    0.023    NA
                  med.r
Cr_dibilit__ABC_1 0.736
Cr_dibilit__ABC_2 0.670
Cr_dibilit__ABC_3 0.622

Corrélations item-total :
                    n raw.r std.r r.cor r.drop  mean    sd
Cr_dibilit__ABC_1 405 0.875 0.863 0.742  0.694 4.025 1.097
Cr_dibilit__ABC_2 405 0.877 0.888 0.807  0.740 3.988 0.937
Cr_dibilit__ABC_3 405 0.903 0.906 0.845  0.777 3.886 0.998

4. Analyse factorielle :</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/analyses_psychometriques-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  1  and the number of components =  NA 

Nombre de facteurs suggéré : 1 

- Loadings :

Loadings:
                  ML1  
Cr_dibilit__ABC_1 0.752
Cr_dibilit__ABC_2 0.827
Cr_dibilit__ABC_3 0.891

                 ML1
SS loadings    2.043
Proportion Var 0.681

- Communalités :
Cr_dibilit__ABC_1 Cr_dibilit__ABC_2 Cr_dibilit__ABC_3 
            0.565             0.684             0.793 

- Variance expliquée : 68.07%

- Résidus :
RMSR = 3.566067e-08 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Congruence</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>items_Cong <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"congruence_signaux_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>analyse_Cong <span class="ot">&lt;-</span> <span class="fu">analyse_psychometrique</span>(merged_df, <span class="st">"Congruence"</span>, items_Cong)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyse psychométrique de Congruence ===

1. Statistiques descriptives :
 congruence_signaux_1 congruence_signaux_2 congruence_signaux_3
 Min.   :1.000        Min.   :1.000        Min.   :1.000       
 1st Qu.:3.000        1st Qu.:3.000        1st Qu.:3.000       
 Median :4.000        Median :4.000        Median :4.000       
 Mean   :3.933        Mean   :4.077        Mean   :3.852       
 3rd Qu.:5.000        3rd Qu.:5.000        3rd Qu.:5.000       
 Max.   :7.000        Max.   :7.000        Max.   :7.000       

2. Tests de normalité et adéquation :
- KMO = 0.716 
- Test de Bartlett : chi2 = 558.56 , ddl = 3 , p = &lt; 2.22e-16 

3. Fiabilité :
- Alpha de Cronbach = 0.853

Statistiques par item si supprimé :
                     raw_alpha std.alpha G6(smc) average_r   S/N alpha se var.r
congruence_signaux_1     0.785     0.788   0.650     0.650 3.712    0.021    NA
congruence_signaux_2     0.752     0.752   0.603     0.603 3.033    0.025    NA
congruence_signaux_3     0.846     0.848   0.736     0.736 5.573    0.015    NA
                     med.r
congruence_signaux_1 0.650
congruence_signaux_2 0.603
congruence_signaux_3 0.736

Corrélations item-total :
                       n raw.r std.r r.cor r.drop  mean    sd
congruence_signaux_1 405 0.887 0.885 0.805  0.733 3.933 1.528
congruence_signaux_2 405 0.897 0.903 0.842  0.774 4.077 1.394
congruence_signaux_3 405 0.857 0.853 0.721  0.671 3.852 1.538

4. Analyse factorielle :</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/analyses_psychometriques-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  1  and the number of components =  NA 

Nombre de facteurs suggéré : 1 

- Loadings :

Loadings:
                     ML1  
congruence_signaux_1 0.826
congruence_signaux_2 0.891
congruence_signaux_3 0.730

                 ML1
SS loadings    2.009
Proportion Var 0.670

- Communalités :
congruence_signaux_1 congruence_signaux_2 congruence_signaux_3 
               0.682                0.794                0.532 

- Variance expliquée : 66.94%

- Résidus :
RMSR = 7.430452e-08 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Image</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>items_Image <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Image_employeur_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>analyse_Image <span class="ot">&lt;-</span> <span class="fu">analyse_psychometrique</span>(merged_df, <span class="st">"Image"</span>, items_Image)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyse psychométrique de Image ===

1. Statistiques descriptives :
 Image_employeur_1 Image_employeur_2 Image_employeur_3
 Min.   :1.00      Min.   :1.000     Min.   :1.00     
 1st Qu.:3.00      1st Qu.:3.000     1st Qu.:3.00     
 Median :5.00      Median :4.000     Median :5.00     
 Mean   :4.38      Mean   :4.064     Mean   :4.43     
 3rd Qu.:5.00      3rd Qu.:5.000     3rd Qu.:6.00     
 Max.   :7.00      Max.   :7.000     Max.   :7.00     

2. Tests de normalité et adéquation :
- KMO = 0.762 
- Test de Bartlett : chi2 = 954.7 , ddl = 3 , p = &lt; 2.22e-16 

3. Fiabilité :
- Alpha de Cronbach = 0.927

Statistiques par item si supprimé :
                  raw_alpha std.alpha G6(smc) average_r   S/N alpha se var.r
Image_employeur_1     0.900     0.901   0.819     0.819 9.071    0.010    NA
Image_employeur_2     0.903     0.903   0.824     0.824 9.350    0.010    NA
Image_employeur_3     0.880     0.881   0.787     0.787 7.381    0.012    NA
                  med.r
Image_employeur_1 0.819
Image_employeur_2 0.824
Image_employeur_3 0.787

Corrélations item-total :
                    n raw.r std.r r.cor r.drop  mean    sd
Image_employeur_1 405 0.929 0.931 0.877  0.844 4.380 1.351
Image_employeur_2 405 0.932 0.930 0.873  0.841 4.064 1.444
Image_employeur_3 405 0.942 0.943 0.904  0.869 4.430 1.376

4. Analyse factorielle :</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/analyses_psychometriques-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  1  and the number of components =  NA 

Nombre de facteurs suggéré : 1 

- Loadings :

Loadings:
                  ML1  
Image_employeur_1 0.889
Image_employeur_2 0.885
Image_employeur_3 0.926

                 ML1
SS loadings    2.431
Proportion Var 0.810

- Communalités :
Image_employeur_1 Image_employeur_2 Image_employeur_3 
            0.791             0.783             0.858 

- Variance expliquée : 81.05%

- Résidus :
RMSR = 1.422821e-09 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FAM</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>items_FAM <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Familiarit__ABC_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>analyse_FAM <span class="ot">&lt;-</span> <span class="fu">analyse_psychometrique</span>(merged_df, <span class="st">"Familiarité"</span>, items_FAM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyse psychométrique de Familiarité ===

1. Statistiques descriptives :
 Familiarit__ABC_1 Familiarit__ABC_2 Familiarit__ABC_3
 Min.   :1.000     Min.   :1.000     Min.   :1.000    
 1st Qu.:1.000     1st Qu.:1.000     1st Qu.:1.000    
 Median :1.000     Median :1.000     Median :1.000    
 Mean   :1.328     Mean   :1.269     Mean   :1.286    
 3rd Qu.:1.000     3rd Qu.:1.000     3rd Qu.:1.000    
 Max.   :7.000     Max.   :6.000     Max.   :6.000    

2. Tests de normalité et adéquation :
- KMO = 0.75 
- Test de Bartlett : chi2 = 1048.21 , ddl = 3 , p = &lt; 2.22e-16 

3. Fiabilité :
- Alpha de Cronbach = 0.929

Statistiques par item si supprimé :
                  raw_alpha std.alpha G6(smc) average_r    S/N alpha se var.r
Familiarit__ABC_1     0.936     0.937   0.881     0.881 14.766    0.006    NA
Familiarit__ABC_2     0.878     0.881   0.787     0.787  7.405    0.012    NA
Familiarit__ABC_3     0.883     0.889   0.801     0.801  8.027    0.011    NA
                  med.r
Familiarit__ABC_1 0.881
Familiarit__ABC_2 0.787
Familiarit__ABC_3 0.801

Corrélations item-total :
                    n raw.r std.r r.cor r.drop  mean    sd
Familiarit__ABC_1 405 0.926 0.919 0.841  0.819 1.328 0.908
Familiarit__ABC_2 405 0.947 0.952 0.926  0.887 1.269 0.773
Familiarit__ABC_3 405 0.944 0.947 0.917  0.875 1.286 0.810

4. Analyse factorielle :</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/analyses_psychometriques-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  1  and the number of components =  NA 

Nombre de facteurs suggéré : 1 

- Loadings :

Loadings:
                  ML1  
Familiarit__ABC_1 0.846
Familiarit__ABC_2 0.946
Familiarit__ABC_3 0.931

                 ML1
SS loadings    2.477
Proportion Var 0.826

- Communalités :
Familiarit__ABC_1 Familiarit__ABC_2 Familiarit__ABC_3 
            0.716             0.895             0.866 

- Variance expliquée : 82.58%

- Résidus :
RMSR = 4.386829e-08 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse de CredE sur subset_noDM car les items sont créés après imputation</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>items_CredE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CredE1"</span>, <span class="st">"CredE2"</span>, <span class="st">"CredE3"</span>, <span class="st">"CredE4"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>analyse_CredE <span class="ot">&lt;-</span> <span class="fu">analyse_psychometrique</span>(subset_noDM, <span class="st">"CredE"</span>, items_CredE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyse psychométrique de CredE ===

1. Statistiques descriptives :
     CredE1          CredE2          CredE3          CredE4     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:3.000   1st Qu.:3.000   1st Qu.:4.000   1st Qu.:3.000  
 Median :4.000   Median :4.000   Median :4.000   Median :4.000  
 Mean   :3.988   Mean   :3.748   Mean   :3.912   Mean   :3.721  
 3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:4.750   3rd Qu.:4.000  
 Max.   :7.000   Max.   :7.000   Max.   :7.000   Max.   :7.000  

2. Tests de normalité et adéquation :
- KMO = 0.781 
- Test de Bartlett : chi2 = 565.16 , ddl = 6 , p = &lt; 2.22e-16 

3. Fiabilité :
- Alpha de Cronbach = 0.829

Statistiques par item si supprimé :
       raw_alpha std.alpha G6(smc) average_r   S/N alpha se var.r med.r
CredE1     0.805     0.817   0.767     0.599 4.474    0.019 0.014 0.550
CredE2     0.836     0.843   0.795     0.642 5.384    0.016 0.008 0.641
CredE3     0.758     0.764   0.702     0.519 3.243    0.024 0.014 0.512
CredE4     0.738     0.752   0.679     0.502 3.029    0.025 0.007 0.550

Corrélations item-total :
         n raw.r std.r r.cor r.drop  mean    sd
CredE1 330 0.800 0.791 0.685  0.616 3.988 1.325
CredE2 330 0.766 0.751 0.608  0.554 3.748 1.353
CredE3 330 0.845 0.863 0.818  0.737 3.912 1.041
CredE4 330 0.870 0.879 0.849  0.760 3.721 1.170

4. Analyse factorielle :</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/analyses_psychometriques-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  1  and the number of components =  NA 

Nombre de facteurs suggéré : 1 

- Loadings :

Loadings:
       ML1  
CredE1 0.698
CredE2 0.606
CredE3 0.829
CredE4 0.887

                 ML1
SS loadings    2.328
Proportion Var 0.582

- Communalités :
CredE1 CredE2 CredE3 CredE4 
 0.488  0.367  0.688  0.787 

- Variance expliquée : 58.22%

- Résidus :
RMSR = 0.02698483 </code></pre>
</div>
</div>
</section>
<section id="analyses-psychométriques-sur-données-imputées" class="level1">
<h1>Analyses psychométriques sur données imputées</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction pour analyser CredE sur les jeux imputés</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>analyse_CredE_imputed <span class="ot">&lt;-</span> <span class="cf">function</span>(imp_datasets, <span class="at">nom_echelle =</span> <span class="st">"CredE (imputé)"</span>, <span class="at">items =</span> <span class="fu">c</span>(<span class="st">"CredE1"</span>, <span class="st">"CredE2"</span>, <span class="st">"CredE3"</span>, <span class="st">"CredE4"</span>)) {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Analyse psychométrique de"</span>, nom_echelle, <span class="st">"sur données imputées ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialisation des résultats</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  alphas <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(imp_datasets))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  kmos <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(imp_datasets))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  variances <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(imp_datasets))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Analyse sur chaque jeu imputé</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(imp_datasets)) {</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> imp_datasets[[i]]</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extraction des données de l'échelle</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    data_echelle <span class="ot">&lt;-</span> data[, items, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    complete_cases <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(data_echelle)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    data_complete <span class="ot">&lt;-</span> data_echelle[complete_cases, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Alpha de Cronbach</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    alpha_res <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(data_echelle)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    alphas[i] <span class="ot">&lt;-</span> alpha_res<span class="sc">$</span>total<span class="sc">$</span>raw_alpha</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># KMO et analyse factorielle</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">sum</span>(complete_cases) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      mat_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_complete)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>      kmo_res <span class="ot">&lt;-</span> <span class="fu">KMO</span>(mat_cor)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>      kmos[i] <span class="ot">&lt;-</span> kmo_res<span class="sc">$</span>MSA</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>      fa_res <span class="ot">&lt;-</span> <span class="fu">fa</span>(data_complete, <span class="at">nfactors =</span> <span class="dv">1</span>, <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>      variances[i] <span class="ot">&lt;-</span> fa_res<span class="sc">$</span>Vaccounted[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Résultats combinés</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Résultats combinés sur"</span>, <span class="fu">length</span>(imp_datasets), <span class="st">"jeux imputés :</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- Alpha de Cronbach moyen ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(alphas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- KMO moyen ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(kmos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- Variance expliquée moyenne ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(variances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha_mean =</span> <span class="fu">mean</span>(alphas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">kmo_mean =</span> <span class="fu">mean</span>(kmos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">variance_mean =</span> <span class="fu">mean</span>(variances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse de CredE sur les jeux imputés PMM</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>analyse_CredE_pmm <span class="ot">&lt;-</span> <span class="fu">analyse_CredE_imputed</span>(subset_pmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyse psychométrique de CredE (imputé) sur données imputées ===

Résultats combinés sur 10 jeux imputés :
- Alpha de Cronbach moyen = 0.821 
- KMO moyen = 0.758 
- Variance expliquée moyenne = 56.98 %</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse de CredE sur les jeux imputés RF</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>analyse_CredE_rf <span class="ot">&lt;-</span> <span class="fu">analyse_CredE_imputed</span>(subset_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyse psychométrique de CredE (imputé) sur données imputées ===

Résultats combinés sur 10 jeux imputés :
- Alpha de Cronbach moyen = 0.801 
- KMO moyen = 0.771 
- Variance expliquée moyenne = 53.46 %</code></pre>
</div>
</div>
<section id="synthèse-des-analyses-psychométriques" class="level2">
<h2 class="anchored" data-anchor-id="synthèse-des-analyses-psychométriques">Synthèse des analyses psychométriques</h2>
<p>Cette section présente les analyses psychométriques des différentes échelles utilisées dans notre étude expérimentale. Ces analyses permettent d’évaluer la qualité et la fiabilité des instruments de mesure avant de procéder aux analyses structurelles.</p>
<section id="crédibilité-de-glassdoor-credgd" class="level3">
<h3 class="anchored" data-anchor-id="crédibilité-de-glassdoor-credgd">Crédibilité de Glassdoor (CredGD)</h3>
<p>L’échelle de crédibilité perçue de Glassdoor comprend quatre items évalués sur une échelle de Likert à 7 points.</p>
<p><strong>Propriétés psychométriques</strong> : - Les scores moyens varient entre 3,77 et 4,25, indiquant une perception modérément positive - L’indice KMO (0,599) est acceptable mais modeste - La fiabilité interne (α = 0,563) est en dessous du seuil conventionnel de 0,70 - L’analyse factorielle suggère une structure à trois facteurs, ce qui est problématique pour une échelle censée mesurer un construit unique - Les saturations factorielles sont hétérogènes (de 0,337 à 0,785) - La variance expliquée est limitée (30,46%)</p>
<p>Cette échelle présente des faiblesses psychométriques qui invitent à interpréter les résultats la concernant avec prudence.</p>
</section>
<section id="crédibilité-de-la-méthode-dévaluation-credme" class="level3">
<h3 class="anchored" data-anchor-id="crédibilité-de-la-méthode-dévaluation-credme">Crédibilité de la Méthode d’Évaluation (CredME)</h3>
<p>Cette échelle à trois items mesure la crédibilité perçue de la méthode d’évaluation utilisée par l’entreprise.</p>
<p><strong>Propriétés psychométriques</strong> : - Les moyennes des items sont homogènes (entre 3,89 et 4,03) - L’indice KMO (0,723) indique une bonne adéquation des données - Excellente fiabilité interne (α = 0,859) - Structure factorielle unidimensionnelle confirmée - Saturations factorielles élevées (0,752 à 0,891) - Variance expliquée satisfaisante (68,07%)</p>
<p>Cette échelle présente d’excellentes qualités psychométriques, soutenant sa validité et sa fiabilité.</p>
</section>
<section id="congruence-des-signaux-cong" class="level3">
<h3 class="anchored" data-anchor-id="congruence-des-signaux-cong">Congruence des Signaux (Cong)</h3>
<p>L’échelle de congruence mesure la cohérence perçue entre les différentes sources d’information.</p>
<p><strong>Propriétés psychométriques</strong> : - Les scores moyens sont homogènes (entre 3,85 et 4,08) - KMO satisfaisant (0,716) - Bonne fiabilité interne (α = 0,853) - Structure factorielle unidimensionnelle confirmée - Saturations factorielles élevées (0,730 à 0,891) - Variance expliquée satisfaisante (66,94%)</p>
<p>Les propriétés psychométriques de cette échelle sont très satisfaisantes.</p>
</section>
<section id="image-de-lemployeur-image" class="level3">
<h3 class="anchored" data-anchor-id="image-de-lemployeur-image">Image de l’Employeur (Image)</h3>
<p>Cette échelle à trois items évalue la perception globale de l’image de l’employeur.</p>
<p><strong>Propriétés psychométriques</strong> : - Scores moyens relativement élevés (entre 4,06 et 4,43) - Excellent KMO (0,762) - Fiabilité interne remarquable (α = 0,927) - Structure factorielle unidimensionnelle confirmée - Saturations factorielles très élevées (0,885 à 0,926) - Variance expliquée excellente (81,05%)</p>
<p>Cette échelle présente des qualités psychométriques exceptionnelles, ce qui en fait une mesure très fiable du concept d’image de l’employeur.</p>
</section>
<section id="familiarité-avec-lentreprise-fam" class="level3">
<h3 class="anchored" data-anchor-id="familiarité-avec-lentreprise-fam">Familiarité avec l’Entreprise (FAM)</h3>
<p>L’échelle de familiarité mesure la connaissance préalable que les participants avaient de l’entreprise.</p>
<p><strong>Propriétés psychométriques</strong> : - Scores moyens très bas (entre 1,27 et 1,33 sur 7) - Bon KMO (0,750) - Fiabilité interne excellente (α = 0,929) - Structure factorielle unidimensionnelle confirmée - Saturations factorielles très élevées (0,846 à 0,946) - Variance expliquée excellente (82,58%)</p>
<p>Les scores très bas indiquent une faible familiarité préalable avec l’entreprise, ce qui est cohérent avec l’utilisation d’une entreprise fictive ou peu connue dans l’expérimentation. Les excellentes propriétés psychométriques confirment néanmoins la validité de cette mesure.</p>
</section>
<section id="crédibilité-de-lévaluateur-crede" class="level3">
<h3 class="anchored" data-anchor-id="crédibilité-de-lévaluateur-crede">Crédibilité de l’Évaluateur (CredE)</h3>
<p>Cette échelle mesure la crédibilité perçue de la source d’évaluation (interne ou externe).</p>
<p><strong>Propriétés psychométriques (sur données complètes)</strong> : - Scores moyens homogènes (entre 3,72 et 3,99) - Bon KMO (0,781) - Fiabilité interne satisfaisante (α = 0,829) - Structure factorielle unidimensionnelle confirmée - Saturations factorielles variables mais acceptables (0,606 à 0,887) - Variance expliquée satisfaisante (58,22%)</p>
<p><strong>Propriétés sur données imputées</strong> : - Méthode PMM : α = 0,821, KMO = 0,758, variance expliquée = 56,98% - Méthode RF : α = 0,801, KMO = 0,771, variance expliquée = 53,46%</p>
<p>La robustesse des indicateurs psychométriques entre les données originales et les données imputées par deux méthodes distinctes (PMM et RF) confirme la stabilité et la fiabilité de cette échelle.</p>
</section>
<section id="conclusion-des-analyses-psychométriques" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-des-analyses-psychométriques">Conclusion des analyses psychométriques</h3>
<p>La majorité des échelles utilisées dans cette étude présentent d’excellentes propriétés psychométriques, avec des coefficients alpha de Cronbach dépassant 0,80, des indices KMO satisfaisants et des structures factorielles clairement unidimensionnelles. Seule l’échelle de crédibilité de Glassdoor (CredGD) montre des faiblesses, avec une fiabilité limitée et une structure factorielle potentiellement multidimensionnelle.</p>
<p>Les résultats similaires obtenus avec les données imputées (PMM et RF) comparés aux données complètes renforcent la confiance dans la stabilité des mesures utilisées et la pertinence des analyses d’imputation multiple pour traiter les données manquantes.</p>
<p>Ces analyses psychométriques robustes constituent un prérequis essentiel pour les analyses structurelles subséquentes, garantissant que les relations entre variables identifiées dans le modèle SEM reposent sur des mesures fiables et valides.</p>
</section>
</section>
</section>
<section id="analyse-de-la-normalité-des-variables-du-modèle" class="level1">
<h1>Analyse de la normalité des variables du modèle</h1>
<p>Avant de procéder aux analyses SEM, il est important d’évaluer la normalité des variables incluses dans notre modèle. Cette étape est cruciale car certaines méthodes d’estimation, comme le Maximum Likelihood (ML), supposent que les données suivent approximativement une distribution normale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction pour tester la normalité d'une variable</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>test_normalite <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var_name) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extraction de la variable</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> data[[var_name]]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test de Shapiro-Wilk</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(var)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcul de l'asymétrie (skewness) et de l'aplatissement (kurtosis)</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  skew_val <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">skew</span>(var)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  kurt_val <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">kurtosi</span>(var)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Retourner les résultats</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> var_name,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">shapiro_p =</span> shapiro_test<span class="sc">$</span>p.value,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">skewness =</span> skew_val,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">kurtosis =</span> kurt_val,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">normal_shapiro =</span> shapiro_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">normal_skew_kurt =</span> <span class="fu">abs</span>(skew_val) <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(kurt_val) <span class="sc">&lt;</span> <span class="dv">2</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables à tester</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>variables_modele <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Image"</span>, <span class="st">"Cong"</span>, <span class="st">"CredE"</span>, <span class="st">"CredGD"</span>, <span class="st">"CredME"</span>)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester la normalité sur les données complètes</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>resultats_normalite <span class="ot">&lt;-</span> <span class="fu">lapply</span>(variables_modele, <span class="cf">function</span>(var) <span class="fu">test_normalite</span>(subset_noDM, var))</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer un tableau de résultats détaillé</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>resultats_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(resultats_normalite, <span class="cf">function</span>(x) {</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> x<span class="sc">$</span>variable,</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shapiro_p =</span> <span class="fu">round</span>(x<span class="sc">$</span>shapiro_p, <span class="dv">4</span>),</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Skewness =</span> <span class="fu">round</span>(x<span class="sc">$</span>skewness, <span class="dv">3</span>),</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Kurtosis =</span> <span class="fu">round</span>(x<span class="sc">$</span>kurtosis, <span class="dv">3</span>),</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Normal_Shapiro =</span> <span class="fu">ifelse</span>(x<span class="sc">$</span>normal_shapiro, <span class="st">"Oui"</span>, <span class="st">"Non"</span>),</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Normal_Skew_Kurt =</span> <span class="fu">ifelse</span>(x<span class="sc">$</span>normal_skew_kurt, <span class="st">"Oui"</span>, <span class="st">"Non"</span>)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le tableau détaillé</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(resultats_df, </span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Tests de normalité des variables du modèle"</span>,</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"p-value (Shapiro-Wilk)"</span>, <span class="st">"Asymétrie"</span>, <span class="st">"Aplatissement"</span>, </span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Normalité (Shapiro)"</span>, <span class="st">"Normalité (Asym./Aplat.)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Tests de normalité des variables du modèle</caption>
<colgroup>
<col style="width: 8%">
<col style="width: 22%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">p-value (Shapiro-Wilk)</th>
<th style="text-align: right;">Asymétrie</th>
<th style="text-align: right;">Aplatissement</th>
<th style="text-align: left;">Normalité (Shapiro)</th>
<th style="text-align: left;">Normalité (Asym./Aplat.)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Image</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.350</td>
<td style="text-align: right;">-0.483</td>
<td style="text-align: left;">Non</td>
<td style="text-align: left;">Oui</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cong</td>
<td style="text-align: right;">0.0026</td>
<td style="text-align: right;">-0.114</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: left;">Non</td>
<td style="text-align: left;">Oui</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CredE</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.723</td>
<td style="text-align: right;">0.473</td>
<td style="text-align: left;">Non</td>
<td style="text-align: left;">Oui</td>
</tr>
<tr class="even">
<td style="text-align: left;">CredGD</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.205</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: left;">Non</td>
<td style="text-align: left;">Oui</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CredME</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.539</td>
<td style="text-align: right;">1.139</td>
<td style="text-align: left;">Non</td>
<td style="text-align: left;">Oui</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistiques descriptives pour chaque variable</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>stats_desc <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(variables_modele, <span class="cf">function</span>(var) {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moyenne =</span> <span class="fu">round</span>(<span class="fu">mean</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ecart_type =</span> <span class="fu">round</span>(<span class="fu">sd</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Minimum =</span> <span class="fu">round</span>(<span class="fu">min</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(subset_noDM[[var]], <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediane =</span> <span class="fu">round</span>(<span class="fu">median</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(subset_noDM[[var]], <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Maximum =</span> <span class="fu">round</span>(<span class="fu">max</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les statistiques descriptives</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(stats_desc, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Statistiques descriptives des variables du modèle"</span>,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Moyenne"</span>, <span class="st">"Écart-type"</span>, <span class="st">"Minimum"</span>, <span class="st">"Q1"</span>, <span class="st">"Médiane"</span>, <span class="st">"Q3"</span>, <span class="st">"Maximum"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Statistiques descriptives des variables du modèle</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Moyenne</th>
<th style="text-align: right;">Écart-type</th>
<th style="text-align: right;">Minimum</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Médiane</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Maximum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">25%</td>
<td style="text-align: left;">Image</td>
<td style="text-align: right;">4.471</td>
<td style="text-align: right;">1.255</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3.667</td>
<td style="text-align: right;">4.667</td>
<td style="text-align: right;">5.333</td>
<td style="text-align: right;">7.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%1</td>
<td style="text-align: left;">Cong</td>
<td style="text-align: right;">4.167</td>
<td style="text-align: right;">1.272</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3.333</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">5.000</td>
<td style="text-align: right;">7.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25%2</td>
<td style="text-align: left;">CredE</td>
<td style="text-align: right;">3.842</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3.312</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">4.500</td>
<td style="text-align: right;">6.250</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%3</td>
<td style="text-align: left;">CredGD</td>
<td style="text-align: right;">4.082</td>
<td style="text-align: right;">0.806</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">3.562</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">4.500</td>
<td style="text-align: right;">6.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25%4</td>
<td style="text-align: left;">CredME</td>
<td style="text-align: right;">4.052</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3.667</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">4.667</td>
<td style="text-align: right;">6.333</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau détaillé des tests de normalité univariée</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>normalite_univariee <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> variables_modele,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Moyenne =</span> <span class="fu">sapply</span>(variables_modele, <span class="cf">function</span>(var) <span class="fu">round</span>(<span class="fu">mean</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>)),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ecart_type =</span> <span class="fu">sapply</span>(variables_modele, <span class="cf">function</span>(var) <span class="fu">round</span>(<span class="fu">sd</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>)),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Skewness =</span> <span class="fu">sapply</span>(variables_modele, <span class="cf">function</span>(var) <span class="fu">round</span>(psych<span class="sc">::</span><span class="fu">skew</span>(subset_noDM[[var]]), <span class="dv">3</span>)),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Kurtosis =</span> <span class="fu">sapply</span>(variables_modele, <span class="cf">function</span>(var) <span class="fu">round</span>(psych<span class="sc">::</span><span class="fu">kurtosi</span>(subset_noDM[[var]]), <span class="dv">3</span>)),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Shapiro_W =</span> <span class="fu">sapply</span>(variables_modele, <span class="cf">function</span>(var) <span class="fu">round</span>(<span class="fu">shapiro.test</span>(subset_noDM[[var]])<span class="sc">$</span>statistic, <span class="dv">3</span>)),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Shapiro_p =</span> <span class="fu">sapply</span>(variables_modele, <span class="cf">function</span>(var) <span class="fu">round</span>(<span class="fu">shapiro.test</span>(subset_noDM[[var]])<span class="sc">$</span>p.value, <span class="dv">4</span>)),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Conclusion =</span> <span class="fu">sapply</span>(variables_modele, <span class="cf">function</span>(var) {</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    skew <span class="ot">&lt;-</span> <span class="fu">abs</span>(psych<span class="sc">::</span><span class="fu">skew</span>(subset_noDM[[var]])) <span class="sc">&lt;</span> <span class="dv">1</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    kurt <span class="ot">&lt;-</span> <span class="fu">abs</span>(psych<span class="sc">::</span><span class="fu">kurtosi</span>(subset_noDM[[var]])) <span class="sc">&lt;</span> <span class="dv">2</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(skew <span class="sc">&amp;&amp;</span> kurt) {</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Acceptable"</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Non normale"</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le tableau détaillé de normalité univariée</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(normalite_univariee, </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Analyse détaillée de la normalité univariée"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Moyenne"</span>, <span class="st">"Écart-type"</span>, <span class="st">"Asymétrie"</span>, <span class="st">"Aplatissement"</span>, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Shapiro-W"</span>, <span class="st">"p-value"</span>, <span class="st">"Conclusion"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Analyse détaillée de la normalité univariée</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Moyenne</th>
<th style="text-align: right;">Écart-type</th>
<th style="text-align: right;">Asymétrie</th>
<th style="text-align: right;">Aplatissement</th>
<th style="text-align: right;">Shapiro-W</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: left;">Conclusion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Image</td>
<td style="text-align: left;">Image</td>
<td style="text-align: right;">4.471</td>
<td style="text-align: right;">1.255</td>
<td style="text-align: right;">-0.350</td>
<td style="text-align: right;">-0.483</td>
<td style="text-align: right;">0.971</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: left;">Acceptable</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cong</td>
<td style="text-align: left;">Cong</td>
<td style="text-align: right;">4.167</td>
<td style="text-align: right;">1.272</td>
<td style="text-align: right;">-0.114</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">0.0026</td>
<td style="text-align: left;">Acceptable</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CredE</td>
<td style="text-align: left;">CredE</td>
<td style="text-align: right;">3.842</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">-0.723</td>
<td style="text-align: right;">0.473</td>
<td style="text-align: right;">0.954</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: left;">Acceptable</td>
</tr>
<tr class="even">
<td style="text-align: left;">CredGD</td>
<td style="text-align: left;">CredGD</td>
<td style="text-align: right;">4.082</td>
<td style="text-align: right;">0.806</td>
<td style="text-align: right;">-0.205</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">0.977</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: left;">Acceptable</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CredME</td>
<td style="text-align: left;">CredME</td>
<td style="text-align: right;">4.052</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">-0.539</td>
<td style="text-align: right;">1.139</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: left;">Acceptable</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des distributions</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables_modele) {</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Histogramme avec courbe de densité</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(subset_noDM[[var]], </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Distribution de"</span>, var),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> var, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">border =</span> <span class="st">"white"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fu">mean</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd =</span> <span class="fu">sd</span>(subset_noDM[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Densité observée"</span>, <span class="st">"Densité normale théorique"</span>),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"red"</span>), </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># QQ-plot</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(subset_noDM[[var]], </span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"QQ-Plot de"</span>, var),</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(subset_noDM[[var]], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/normalite_variables-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analyse_vf_files/figure-html/normalite_variables-2.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse de la normalité multivariée</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Test de normalité multivariée ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Test de normalité multivariée ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'MVN' a été compilé avec la version R 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mvn_result <span class="ot">&lt;-</span> <span class="fu">mvn</span>(subset_noDM[, variables_modele], <span class="at">mvnTest =</span> <span class="st">"mardia"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mvn_result<span class="sc">$</span>multivariateNormality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Test        Statistic              p value Result
1 Mardia Skewness 127.727293651217  1.7587186105277e-12     NO
2 Mardia Kurtosis 7.07335148949932 1.51234580414439e-12     NO
3             MVN             &lt;NA&gt;                 &lt;NA&gt;     NO</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspecter la structure du résultat pour comprendre le problème</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Structure du résultat du test de Mardia ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Structure du résultat du test de Mardia ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre de lignes dans le résultat:"</span>, <span class="fu">nrow</span>(mvn_result<span class="sc">$</span>multivariateNormality), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre de lignes dans le résultat: 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Noms des tests:"</span>, <span class="fu">as.character</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span>Test), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Noms des tests: Mardia Skewness Mardia Kurtosis MVN </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer le tableau de normalité multivariée en extrayant spécifiquement les lignes pour l'asymétrie et l'aplatissement</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>mardia_skew_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span>Test <span class="sc">==</span> <span class="st">"Mardia Skewness"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>mardia_kurt_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span>Test <span class="sc">==</span> <span class="st">"Mardia Kurtosis"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau récapitulatif de la normalité multivariée</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>mardia_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"Asymétrie multivariée (Mardia)"</span>, <span class="st">"Aplatissement multivarié (Mardia)"</span>),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistique =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span>Statistic[<span class="fu">c</span>(mardia_skew_idx, mardia_kurt_idx)])),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span><span class="st">`</span><span class="at">p value</span><span class="st">`</span>[<span class="fu">c</span>(mardia_skew_idx, mardia_kurt_idx)]))</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter la conclusion basée sur les valeurs p numériques</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>mardia_results<span class="sc">$</span>Conclusion <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mardia_results<span class="sc">$</span>p_value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normale"</span>, <span class="st">"Non normale"</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Formater les valeurs p pour l'affichage</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>mardia_results<span class="sc">$</span>p_value_formatted <span class="ot">&lt;-</span> <span class="fu">format</span>(mardia_results<span class="sc">$</span>p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le tableau de normalité multivariée</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mardia_results[, <span class="fu">c</span>(<span class="st">"Test"</span>, <span class="st">"Statistique"</span>, <span class="st">"p_value_formatted"</span>, <span class="st">"Conclusion"</span>)], </span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Résultats des tests de normalité multivariée"</span>,</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Test"</span>, <span class="st">"Statistique"</span>, <span class="st">"p-value"</span>, <span class="st">"Conclusion"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Résultats des tests de normalité multivariée</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: right;">Statistique</th>
<th style="text-align: left;">p-value</th>
<th style="text-align: left;">Conclusion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Asymétrie multivariée (Mardia)</td>
<td style="text-align: right;">127.727294</td>
<td style="text-align: left;">1.759e-12</td>
<td style="text-align: left;">Non normale</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aplatissement multivarié (Mardia)</td>
<td style="text-align: right;">7.073352</td>
<td style="text-align: left;">1.512e-12</td>
<td style="text-align: left;">Non normale</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter une interprétation explicite des résultats de Mardia</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">**Interprétation du test de Mardia :**</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
**Interprétation du test de Mardia :**</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Asymétrie multivariée : Statistique ="</span>, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span>Statistic[mardia_skew_idx])), <span class="dv">3</span>), </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p-value ="</span>, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span><span class="st">`</span><span class="at">p value</span><span class="st">`</span>[mardia_skew_idx])), <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">4</span>), </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Asymétrie multivariée : Statistique = 127.727 , p-value = 1.759e-12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Aplatissement multivarié : Statistique ="</span>, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span>Statistic[mardia_kurt_idx])), <span class="dv">3</span>), </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p-value ="</span>, </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(mvn_result<span class="sc">$</span>multivariateNormality<span class="sc">$</span><span class="st">`</span><span class="at">p value</span><span class="st">`</span>[mardia_kurt_idx])), <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">4</span>), </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Aplatissement multivarié : Statistique = 7.073 , p-value = 1.512e-12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Conclusion : Les deux tests indiquent une déviation significative de la normalité multivariée (p &lt; 0.05).</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Conclusion : Les deux tests indiquent une déviation significative de la normalité multivariée (p &lt; 0.05).</code></pre>
</div>
</div>
<section id="interprétation-des-tests-de-normalité" class="level2">
<h2 class="anchored" data-anchor-id="interprétation-des-tests-de-normalité">Interprétation des tests de normalité</h2>
<p>L’analyse de la normalité des variables clés de notre modèle révèle plusieurs points importants :</p>
<section id="normalité-univariée" class="level3">
<h3 class="anchored" data-anchor-id="normalité-univariée">Normalité univariée</h3>
<ol type="1">
<li><p><strong>Test de Shapiro-Wilk</strong> : Ce test formel de normalité est très sensible aux écarts, surtout avec des échantillons de taille moyenne à grande. Nos résultats montrent que toutes les variables principales (Image, Cong, CredE, CredGD, CredME) s’écartent significativement d’une distribution normale selon ce test (p &lt; 0.05).</p></li>
<li><p><strong>Asymétrie (Skewness)</strong> : L’asymétrie mesure le degré de déséquilibre de la distribution. Nos variables présentent des valeurs d’asymétrie modérées :</p>
<ul>
<li>Image : asymétrie négative (-0.350), indiquant une tendance vers des valeurs plus élevées</li>
<li>Cong : quasi-symétrique (-0.114)</li>
<li>CredE : asymétrie négative modérée (-0.723)</li>
<li>CredGD : légère asymétrie négative (-0.205)</li>
<li>CredME : asymétrie négative modérée (-0.539)</li>
</ul>
<p>Ces valeurs restent toutes dans la plage acceptable (|skewness| &lt; 1), suggérant des déviations modérées de la normalité.</p></li>
<li><p><strong>Aplatissement (Kurtosis)</strong> : L’aplatissement mesure la concentration des valeurs autour de la moyenne. Nos variables montrent :</p>
<ul>
<li>Image : distribution légèrement plus aplatie (-0.483) qu’une normale</li>
<li>Cong : distribution légèrement plus aplatie (-0.351)</li>
<li>CredE : distribution légèrement plus pointue (0.473)</li>
<li>CredGD : distribution légèrement plus pointue (0.490)</li>
<li>CredME : distribution plus pointue (1.139), mais toujours dans la plage acceptable</li>
</ul>
<p>Ces valeurs restent toutes dans la plage acceptable (|kurtosis| &lt; 2).</p></li>
</ol>
</section>
<section id="normalité-multivariée" class="level3">
<h3 class="anchored" data-anchor-id="normalité-multivariée">Normalité multivariée</h3>
<p>Le test de Mardia indique une déviation significative de la normalité multivariée, avec un coefficient d’asymétrie multivariée de 127.73 (p = 1.76e-12) et un coefficient d’aplatissement multivarié de 7.07 (p = 1.51e-12). Cette déviation est courante dans les données issues de questionnaires utilisant des échelles de Likert.</p>
</section>
<section id="implications-pour-lanalyse-sem" class="level3">
<h3 class="anchored" data-anchor-id="implications-pour-lanalyse-sem">Implications pour l’analyse SEM</h3>
<p>Bien que nos variables s’écartent de la normalité selon les tests formels, les indicateurs d’asymétrie et d’aplatissement restent dans des plages acceptables. Cette situation est typique des données issues de questionnaires en sciences sociales. Pour tenir compte de ces écarts modérés à la normalité, nous avons utilisé l’estimateur MLR (Maximum Likelihood avec erreurs standard robustes) dans nos analyses SEM, qui est robuste aux violations modérées de l’hypothèse de normalité.</p>
<p>Les histogrammes et QQ-plots confirment visuellement que, malgré des déviations statistiquement significatives, nos distributions restent raisonnablement proches de la normalité, avec des déviations principalement aux extrémités des distributions.</p>
<p>Cette analyse de normalité justifie notre choix méthodologique d’utiliser l’estimateur MLR pour les analyses SEM, offrant ainsi un bon compromis entre précision des estimations et robustesse face aux écarts modérés de normalité observés dans nos données.</p>
</section>
</section>
</section>
<section id="analyses-sem" class="level1">
<h1>4. Analyses SEM</h1>
<section id="méthode-déquations-structurelles-sem" class="level2">
<h2 class="anchored" data-anchor-id="méthode-déquations-structurelles-sem">Méthode d’équations structurelles (SEM)</h2>
<p>Dans cette section, nous utilisons la modélisation par équations structurelles pour analyser les relations directes et indirectes entre nos variables, conformément au cadre conceptuel présenté dans le diagramme initial. Cette approche nous permet d’évaluer simultanément plusieurs chemins de médiation et de quantifier leurs effets respectifs.</p>
<p>Notre stratégie analytique comprend trois approches comparatives du traitement des données manquantes : 1. Analyse sur cas complets (noDM) : utilisation uniquement des observations sans données manquantes 2. Imputation multiple par Predictive Mean Matching (PMM) : 10 jeux de données imputés 3. Imputation multiple par Random Forest (RF) : également 10 jeux de données imputés</p>
<p>Pour chaque approche, nous utilisons l’estimateur MLR (Maximum Likelihood avec erreurs standard robustes) qui offre une meilleure résistance aux déviations de normalité révélées par les tests de normalité.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données imputées</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>prepare_imputed_data <span class="ot">&lt;-</span> <span class="cf">function</span>(imp_list) {</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(imp_list, <span class="cf">function</span>(df) {</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vérifier si CredE existe, sinon la créer</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="st">"CredE"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df)) {</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Vérifier si les composants existent</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>      has_components <span class="ot">&lt;-</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"CredE1"</span>, <span class="st">"CredE2"</span>, <span class="st">"CredE3"</span>, <span class="st">"CredE4"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(df))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (has_components) {</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Créer CredE à partir des composants existants</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>        df<span class="sc">$</span>CredE <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(df[, <span class="fu">c</span>(<span class="st">"CredE1"</span>, <span class="st">"CredE2"</span>, <span class="st">"CredE3"</span>, <span class="st">"CredE4"</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Variable CredE créée à partir des composants existants</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Créer les composants si nécessaire</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="st">"CredE1"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df) <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"Source"</span>, <span class="st">"Cr_dibilit__baro_int_1"</span>, <span class="st">"cr_dibilit__baro_ext_1"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>          df<span class="sc">$</span>CredE1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>Source <span class="sc">==</span> <span class="dv">1</span>, df<span class="sc">$</span>Cr_dibilit__baro_int_1, df<span class="sc">$</span>cr_dibilit__baro_ext_1)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"Variable CredE1 créée</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="st">"CredE2"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df) <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"Source"</span>, <span class="st">"Cr_dibilit__baro_int_2"</span>, <span class="st">"cr_dibilit__baro_ext_2"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>          df<span class="sc">$</span>CredE2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>Source <span class="sc">==</span> <span class="dv">1</span>, df<span class="sc">$</span>Cr_dibilit__baro_int_2, df<span class="sc">$</span>cr_dibilit__baro_ext_2)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"Variable CredE2 créée</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="st">"CredE3"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df) <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"Source"</span>, <span class="st">"Cr_dibilit__baro_int_3"</span>, <span class="st">"cr_dibilit__baro_ext_3"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>          df<span class="sc">$</span>CredE3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>Source <span class="sc">==</span> <span class="dv">1</span>, df<span class="sc">$</span>Cr_dibilit__baro_int_3, df<span class="sc">$</span>cr_dibilit__baro_ext_3)</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"Variable CredE3 créée</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="st">"CredE4"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df) <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"Source"</span>, <span class="st">"Cr_dibilit__baro_int_4"</span>, <span class="st">"cr_dibilit__baro_ext_4"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>          df<span class="sc">$</span>CredE4 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>Source <span class="sc">==</span> <span class="dv">1</span>, df<span class="sc">$</span>Cr_dibilit__baro_int_4, df<span class="sc">$</span>cr_dibilit__baro_ext_4)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"Variable CredE4 créée</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Maintenant créer CredE</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"CredE1"</span>, <span class="st">"CredE2"</span>, <span class="st">"CredE3"</span>, <span class="st">"CredE4"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>          df<span class="sc">$</span>CredE <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(df[, <span class="fu">c</span>(<span class="st">"CredE1"</span>, <span class="st">"CredE2"</span>, <span class="st">"CredE3"</span>, <span class="st">"CredE4"</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"Variable CredE créée à partir des composants nouvellement créés</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">warning</span>(<span class="st">"Impossible de créer CredE: composants manquants"</span>)</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convertir toutes les variables en numérique</span></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>    df[] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, as.numeric)</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(df)</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>subset_pmm_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_imputed_data</span>(subset_pmm)</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>subset_rf_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_imputed_data</span>(subset_rf)</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir Note en numérique dans subset_noDM aussi</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>subset_noDM<span class="sc">$</span>Note <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(subset_noDM<span class="sc">$</span>Note)</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle SEM avec variables de contrôle</span></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>model_with_ctrl <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a><span class="st"># Equation finale (Image)</span></span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a><span class="st">Image ~ b1*CredME + b2*Note + b3*FAM + b4*age_num</span></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a><span class="st"># Médiations</span></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a><span class="st">CredME ~ a1*CredE + a2*CredGD</span></span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a><span class="st">CredE ~ c1*Cong + c2*Source</span></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a><span class="st">CredGD ~ d1*Cong + d2*Note</span></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a><span class="st">Cong ~ e1*Note + e2*Source</span></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a><span class="st"># Effets indirects</span></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a><span class="st">ind1 := e2 * c1 * a1 * b1</span></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a><span class="st">ind2 := e2 * d1 * a2 * b1</span></span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a><span class="st">ind3 := c2 * a1 * b1</span></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a><span class="st">ind4 := e1 * d1 * a2 * b1</span></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a><span class="st">ind5 := e1 * c1 * a1 * b1</span></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a><span class="st">ind6 := d2 * a2 * b1</span></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a><span class="st"># Effets totaux</span></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a><span class="st">tot_ind := ind1 + ind2 + ind3 + ind4 + ind5 + ind6</span></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a><span class="st">tot_effect := tot_ind + b2</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. ANALYSES SUR DONNÉES COMPLÈTES</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">==========================================================="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

===========================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== RÉSULTATS SEM - DONNÉES COMPLÈTES (noDM) ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== RÉSULTATS SEM - DONNÉES COMPLÈTES (noDM) ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"===========================================================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>===========================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>fit_noDM <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_with_ctrl, <span class="at">data =</span> subset_noDM, <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Indices d'ajustement</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== INDICES D'AJUSTEMENT ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== INDICES D'AJUSTEMENT ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>fit_indices_noDM <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(fit_noDM)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Chi² = %.3f (df=%d, p=%.4f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>            fit_indices_noDM[<span class="st">"chisq"</span>], </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>            fit_indices_noDM[<span class="st">"df"</span>], </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>            fit_indices_noDM[<span class="st">"pvalue"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi² = 90.340 (df=18, p=0.0000)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"CFI = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_noDM[<span class="st">"cfi"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CFI = 0.890</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"TLI = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_noDM[<span class="st">"tli"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TLI = 0.817</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"RMSEA = %.3f [%.3f; %.3f]</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>            fit_indices_noDM[<span class="st">"rmsea"</span>], </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>            fit_indices_noDM[<span class="st">"rmsea.ci.lower"</span>], </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>            fit_indices_noDM[<span class="st">"rmsea.ci.upper"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSEA = 0.110 [0.088; 0.133]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SRMR = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_noDM[<span class="st">"srmr"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SRMR = 0.079</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients et significativité</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== COEFFICIENTS DES CHEMINS ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== COEFFICIENTS DES CHEMINS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utiliser standardizedSolution pour obtenir les coefficients standardisés</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>coefs_noDM <span class="ot">&lt;-</span> <span class="fu">standardizedSolution</span>(fit_noDM)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrer les chemins de régression et effets indirects</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>reg_paths <span class="ot">&lt;-</span> coefs_noDM[coefs_noDM<span class="sc">$</span>op <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"~"</span>, <span class="st">":="</span>), ]</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Chemins de régression directs</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Régressions directes:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Régressions directes:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>direct_paths <span class="ot">&lt;-</span> reg_paths[reg_paths<span class="sc">$</span>op <span class="sc">==</span> <span class="st">"~"</span>, ]</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(direct_paths)) {</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  signif <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (direct_paths<span class="sc">$</span>pvalue[i] <span class="sc">&lt;</span> <span class="fl">0.001</span>) signif <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (direct_paths<span class="sc">$</span>pvalue[i] <span class="sc">&lt;</span> <span class="fl">0.01</span>) signif <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (direct_paths<span class="sc">$</span>pvalue[i] <span class="sc">&lt;</span> <span class="fl">0.05</span>) signif <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (direct_paths<span class="sc">$</span>pvalue[i] <span class="sc">&lt;</span> <span class="fl">0.1</span>) signif <span class="ot">&lt;-</span> <span class="st">"."</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%s ~ %s (%.3f, p=%.4f) %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>              direct_paths<span class="sc">$</span>lhs[i], </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>              direct_paths<span class="sc">$</span>rhs[i], </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>              direct_paths<span class="sc">$</span>est.std[i], </span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>              direct_paths<span class="sc">$</span>pvalue[i],</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>              signif))</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Image ~ CredME (0.497, p=0.0000) ***
Image ~ Note (0.314, p=0.0000) ***
Image ~ FAM (0.015, p=0.7505) 
Image ~ age_num (0.086, p=0.0089) **
CredME ~ CredE (0.513, p=0.0000) ***
CredME ~ CredGD (0.308, p=0.0000) ***
CredE ~ Cong (0.226, p=0.0000) ***
CredE ~ Source (0.341, p=0.0000) ***
CredGD ~ Cong (0.261, p=0.0001) ***
CredGD ~ Note (0.069, p=0.3196) 
Cong ~ Note (0.594, p=0.0000) ***
Cong ~ Source (0.024, p=0.5816) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effets indirects</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effets indirects et totaux:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Effets indirects et totaux:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>indirect_paths <span class="ot">&lt;-</span> reg_paths[reg_paths<span class="sc">$</span>op <span class="sc">==</span> <span class="st">":="</span>, ]</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(indirect_paths)) {</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  signif <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (indirect_paths<span class="sc">$</span>pvalue[i] <span class="sc">&lt;</span> <span class="fl">0.001</span>) signif <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (indirect_paths<span class="sc">$</span>pvalue[i] <span class="sc">&lt;</span> <span class="fl">0.01</span>) signif <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (indirect_paths<span class="sc">$</span>pvalue[i] <span class="sc">&lt;</span> <span class="fl">0.05</span>) signif <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (indirect_paths<span class="sc">$</span>pvalue[i] <span class="sc">&lt;</span> <span class="fl">0.1</span>) signif <span class="ot">&lt;-</span> <span class="st">"."</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%s = %.3f (p=%.4f) %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>              indirect_paths<span class="sc">$</span>label[i], </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>              indirect_paths<span class="sc">$</span>est.std[i], </span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>              indirect_paths<span class="sc">$</span>pvalue[i],</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>              signif))</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ind1 = 0.001 (p=0.5963) 
ind2 = 0.001 (p=0.5972) 
ind3 = 0.087 (p=0.0000) ***
ind4 = 0.024 (p=0.0028) **
ind5 = 0.034 (p=0.0002) ***
ind6 = 0.011 (p=0.3270) 
tot_ind = 0.158 (p=0.0000) ***
tot_effect = 0.471 (p=0.0000) ***</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. ANALYSES SUR DONNÉES IMPUTÉES PMM</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">==========================================================="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

===========================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== RÉSULTATS SEM - IMPUTATION PMM ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== RÉSULTATS SEM - IMPUTATION PMM ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"===========================================================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>===========================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle sur chaque jeu imputé</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ajustement du modèle SEM sur chaque jeu imputé PMM...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ajustement du modèle SEM sur chaque jeu imputé PMM...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>fit_pmm_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">length</span>(subset_pmm_prepared))</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>successful_fits <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Initialisation de successful_fits</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle sur chaque jeu imputé manuellement</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(subset_pmm_prepared)) {</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    fit_pmm_list[[i]] <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_with_ctrl, <span class="at">data =</span> subset_pmm_prepared[[i]], <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Modèle"</span>, i, <span class="st">"ajusté avec succès</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Erreur lors de l'ajustement du modèle pour le jeu"</span>, i, <span class="st">":"</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    fit_pmm_list[[i]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modèle 1 ajusté avec succès
Modèle 2 ajusté avec succès
Modèle 3 ajusté avec succès
Modèle 4 ajusté avec succès
Modèle 5 ajusté avec succès
Modèle 6 ajusté avec succès
Modèle 7 ajusté avec succès
Modèle 8 ajusté avec succès
Modèle 9 ajusté avec succès
Modèle 10 ajusté avec succès</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier combien de modèles ont été ajustés avec succès</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>successful_fits <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">sapply</span>(fit_pmm_list, is.null))</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre de modèles ajustés avec succès:"</span>, successful_fits, <span class="st">"sur"</span>, <span class="fu">length</span>(subset_pmm_prepared), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre de modèles ajustés avec succès: 10 sur 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si aucun modèle n'a été ajusté avec succès, arrêter ici</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (successful_fits <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Aucun modèle n'a pu être ajusté. Vérifiez les données et le modèle.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extraction manuelle des paramètres pour le pooling</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  param_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, successful_fits)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  successful_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">sapply</span>(fit_pmm_list, is.null))</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>successful_fits) {</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> successful_idx[i]</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extraire les paramètres standardisés</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">&lt;-</span> <span class="fu">standardizedSolution</span>(fit_pmm_list[[idx]])</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrer pour ne garder que les chemins de régression et effets indirects</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">&lt;-</span> params[params<span class="sc">$</span>op <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"~"</span>, <span class="st">":="</span>), ]</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Créer un dataframe avec les colonnes nécessaires pour le pooling</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>    param_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> <span class="fu">paste</span>(params<span class="sc">$</span>lhs, params<span class="sc">$</span>op, params<span class="sc">$</span>rhs),</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> params<span class="sc">$</span>est.std,</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> params<span class="sc">$</span>se,</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> params<span class="sc">$</span>z,</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> params<span class="sc">$</span>pvalue</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>    param_list[[i]] <span class="ot">&lt;-</span> param_df</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vérifier que tous les param_list ont le même nombre de lignes</span></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>  nrows <span class="ot">&lt;-</span> <span class="fu">sapply</span>(param_list, nrow)</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(nrows)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Attention: Les modèles n'ont pas tous le même nombre de paramètres.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Utiliser le nombre minimum de paramètres communs</span></span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>    min_nrow <span class="ot">&lt;-</span> <span class="fu">min</span>(nrows)</span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>    param_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(param_list, <span class="cf">function</span>(x) x[<span class="dv">1</span><span class="sc">:</span>min_nrow, ])</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pooling manuel des résultats</span></span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>  pooled_results <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">nrow</span>(param_list[[<span class="dv">1</span>]]))</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(param_list[[<span class="dv">1</span>]])) {</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extraire les estimations et erreurs standard pour ce paramètre</span></span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>    estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(param_list, <span class="cf">function</span>(x) x<span class="sc">$</span>estimate[j])</span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>    std.errors <span class="ot">&lt;-</span> <span class="fu">sapply</span>(param_list, <span class="cf">function</span>(x) x<span class="sc">$</span>std.error[j])</span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la moyenne des estimations</span></span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>    q_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(estimates)</span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la variance intra-imputation</span></span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>    u_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(std.errors<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la variance inter-imputation</span></span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">var</span>(estimates)</span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la variance totale selon les règles de Rubin</span></span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> u_bar <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>successful_fits) <span class="sc">*</span> b</span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer les degrés de liberté</span></span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> (successful_fits <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> u_bar <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>successful_fits) <span class="sc">*</span> b))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la statistique t et la p-value</span></span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="ot">&lt;-</span> q_bar <span class="sc">/</span> <span class="fu">sqrt</span>(t)</span>
<span id="cb93-62"><a href="#cb93-62" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat), <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb93-63"><a href="#cb93-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-64"><a href="#cb93-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stocker les résultats</span></span>
<span id="cb93-65"><a href="#cb93-65" aria-hidden="true" tabindex="-1"></a>    pooled_results[[j]] <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb93-66"><a href="#cb93-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> param_list[[<span class="dv">1</span>]]<span class="sc">$</span>term[j],</span>
<span id="cb93-67"><a href="#cb93-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> q_bar,</span>
<span id="cb93-68"><a href="#cb93-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="fu">sqrt</span>(t),</span>
<span id="cb93-69"><a href="#cb93-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> t_stat,</span>
<span id="cb93-70"><a href="#cb93-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> p_value,</span>
<span id="cb93-71"><a href="#cb93-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">df =</span> df</span>
<span id="cb93-72"><a href="#cb93-72" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-73"><a href="#cb93-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-74"><a href="#cb93-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-75"><a href="#cb93-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convertir en dataframe</span></span>
<span id="cb93-76"><a href="#cb93-76" aria-hidden="true" tabindex="-1"></a>  pooled_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(pooled_results, <span class="cf">function</span>(x) {</span>
<span id="cb93-77"><a href="#cb93-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb93-78"><a href="#cb93-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> x[<span class="st">"term"</span>],</span>
<span id="cb93-79"><a href="#cb93-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> <span class="fu">as.numeric</span>(x[<span class="st">"estimate"</span>]),</span>
<span id="cb93-80"><a href="#cb93-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="fu">as.numeric</span>(x[<span class="st">"std.error"</span>]),</span>
<span id="cb93-81"><a href="#cb93-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="fu">as.numeric</span>(x[<span class="st">"statistic"</span>]),</span>
<span id="cb93-82"><a href="#cb93-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> <span class="fu">as.numeric</span>(x[<span class="st">"p.value"</span>]),</span>
<span id="cb93-83"><a href="#cb93-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">df =</span> <span class="fu">as.numeric</span>(x[<span class="st">"df"</span>])</span>
<span id="cb93-84"><a href="#cb93-84" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-85"><a href="#cb93-85" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb93-86"><a href="#cb93-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-87"><a href="#cb93-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Affichage des résultats poolés</span></span>
<span id="cb93-88"><a href="#cb93-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== RÉSULTATS POOLÉS (PMM) ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb93-89"><a href="#cb93-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-90"><a href="#cb93-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Chemins de régression directs</span></span>
<span id="cb93-91"><a href="#cb93-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Régressions directes:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb93-92"><a href="#cb93-92" aria-hidden="true" tabindex="-1"></a>  direct_paths_pmm <span class="ot">&lt;-</span> pooled_df[<span class="fu">grepl</span>(<span class="st">" ~ "</span>, pooled_df<span class="sc">$</span>term), ]</span>
<span id="cb93-93"><a href="#cb93-93" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(direct_paths_pmm)) {</span>
<span id="cb93-94"><a href="#cb93-94" aria-hidden="true" tabindex="-1"></a>    signif <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb93-95"><a href="#cb93-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (direct_paths_pmm<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.001</span>) signif <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb93-96"><a href="#cb93-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (direct_paths_pmm<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.01</span>) signif <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb93-97"><a href="#cb93-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (direct_paths_pmm<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.05</span>) signif <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb93-98"><a href="#cb93-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (direct_paths_pmm<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.1</span>) signif <span class="ot">&lt;-</span> <span class="st">"."</span></span>
<span id="cb93-99"><a href="#cb93-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-100"><a href="#cb93-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%s (β=%.3f, p=%.4f) %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb93-101"><a href="#cb93-101" aria-hidden="true" tabindex="-1"></a>                direct_paths_pmm<span class="sc">$</span>term[i],</span>
<span id="cb93-102"><a href="#cb93-102" aria-hidden="true" tabindex="-1"></a>                direct_paths_pmm<span class="sc">$</span>estimate[i], </span>
<span id="cb93-103"><a href="#cb93-103" aria-hidden="true" tabindex="-1"></a>                direct_paths_pmm<span class="sc">$</span>p.value[i],</span>
<span id="cb93-104"><a href="#cb93-104" aria-hidden="true" tabindex="-1"></a>                signif))</span>
<span id="cb93-105"><a href="#cb93-105" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-106"><a href="#cb93-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-107"><a href="#cb93-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Effets indirects</span></span>
<span id="cb93-108"><a href="#cb93-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effets indirects et totaux:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb93-109"><a href="#cb93-109" aria-hidden="true" tabindex="-1"></a>  indirect_paths_pmm <span class="ot">&lt;-</span> pooled_df[<span class="fu">grepl</span>(<span class="st">" := "</span>, pooled_df<span class="sc">$</span>term), ]</span>
<span id="cb93-110"><a href="#cb93-110" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(indirect_paths_pmm)) {</span>
<span id="cb93-111"><a href="#cb93-111" aria-hidden="true" tabindex="-1"></a>    signif <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb93-112"><a href="#cb93-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (indirect_paths_pmm<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.001</span>) signif <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb93-113"><a href="#cb93-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (indirect_paths_pmm<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.01</span>) signif <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb93-114"><a href="#cb93-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (indirect_paths_pmm<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.05</span>) signif <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb93-115"><a href="#cb93-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (indirect_paths_pmm<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.1</span>) signif <span class="ot">&lt;-</span> <span class="st">"."</span></span>
<span id="cb93-116"><a href="#cb93-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-117"><a href="#cb93-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%s (β=%.3f, p=%.4f) %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb93-118"><a href="#cb93-118" aria-hidden="true" tabindex="-1"></a>                indirect_paths_pmm<span class="sc">$</span>term[i],</span>
<span id="cb93-119"><a href="#cb93-119" aria-hidden="true" tabindex="-1"></a>                indirect_paths_pmm<span class="sc">$</span>estimate[i], </span>
<span id="cb93-120"><a href="#cb93-120" aria-hidden="true" tabindex="-1"></a>                indirect_paths_pmm<span class="sc">$</span>p.value[i],</span>
<span id="cb93-121"><a href="#cb93-121" aria-hidden="true" tabindex="-1"></a>                signif))</span>
<span id="cb93-122"><a href="#cb93-122" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-123"><a href="#cb93-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-124"><a href="#cb93-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour PMM - Calcul et affichage des indices d'ajustement moyens</span></span>
<span id="cb93-125"><a href="#cb93-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== INDICES D'AJUSTEMENT MOYENS (PMM) ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb93-126"><a href="#cb93-126" aria-hidden="true" tabindex="-1"></a>  fit_indices_pmm <span class="ot">&lt;-</span> <span class="fu">lapply</span>(fit_pmm_list[<span class="sc">!</span><span class="fu">sapply</span>(fit_pmm_list, is.null)], fitMeasures)</span>
<span id="cb93-127"><a href="#cb93-127" aria-hidden="true" tabindex="-1"></a>  fit_indices_pmm_mean <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, fit_indices_pmm) <span class="sc">/</span> <span class="fu">length</span>(fit_indices_pmm)</span>
<span id="cb93-128"><a href="#cb93-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-129"><a href="#cb93-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Chi² moyen = %.3f (df=%.0f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb93-130"><a href="#cb93-130" aria-hidden="true" tabindex="-1"></a>              fit_indices_pmm_mean[<span class="st">"chisq"</span>], </span>
<span id="cb93-131"><a href="#cb93-131" aria-hidden="true" tabindex="-1"></a>              fit_indices_pmm_mean[<span class="st">"df"</span>]))</span>
<span id="cb93-132"><a href="#cb93-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"CFI moyen = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_pmm_mean[<span class="st">"cfi"</span>]))</span>
<span id="cb93-133"><a href="#cb93-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"TLI moyen = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_pmm_mean[<span class="st">"tli"</span>]))</span>
<span id="cb93-134"><a href="#cb93-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"RMSEA moyen = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_pmm_mean[<span class="st">"rmsea"</span>]))</span>
<span id="cb93-135"><a href="#cb93-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SRMR moyen = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_pmm_mean[<span class="st">"srmr"</span>]))</span>
<span id="cb93-136"><a href="#cb93-136" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== RÉSULTATS POOLÉS (PMM) ===

Régressions directes:
Image ~ CredME (β=0.482, p=0.0000) ***
Image ~ Note (β=0.336, p=0.0000) ***
Image ~ FAM (β=-0.000, p=0.9942) 
Image ~ age_num (β=0.088, p=0.0021) **
CredME ~ CredE (β=0.493, p=0.0000) ***
CredME ~ CredGD (β=0.298, p=0.0000) ***
CredE ~ Cong (β=0.247, p=0.0000) ***
CredE ~ Source (β=0.356, p=0.0000) ***
CredGD ~ Cong (β=0.228, p=0.0003) ***
CredGD ~ Note (β=0.098, p=0.1332) 
Cong ~ Note (β=0.617, p=0.0000) ***
Cong ~ Source (β=0.025, p=0.5244) 

Effets indirects et totaux:
ind1 := e2*c1*a1*b1 (β=0.001, p=0.5410) 
ind2 := e2*d1*a2*b1 (β=0.001, p=0.5460) 
ind3 := c2*a1*b1 (β=0.084, p=0.0000) ***
ind4 := e1*d1*a2*b1 (β=0.020, p=0.0041) **
ind5 := e1*c1*a1*b1 (β=0.036, p=0.0002) ***
ind6 := d2*a2*b1 (β=0.014, p=0.1407) 
tot_ind := ind1+ind2+ind3+ind4+ind5+ind6 (β=0.157, p=0.0000) ***
tot_effect := tot_ind+b2 (β=0.493, p=0.0000) ***

=== INDICES D'AJUSTEMENT MOYENS (PMM) ===
Chi² moyen = 79.732 (df=18)
CFI moyen = 0.925
TLI moyen = 0.874
RMSEA moyen = 0.092
SRMR moyen = 0.063</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. ANALYSES SUR DONNÉES IMPUTÉES RF</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">==========================================================="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

===========================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== RÉSULTATS SEM - IMPUTATION RF ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== RÉSULTATS SEM - IMPUTATION RF ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"===========================================================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>===========================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle sur chaque jeu imputé</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ajustement du modèle SEM sur chaque jeu imputé RF...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ajustement du modèle SEM sur chaque jeu imputé RF...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>fit_rf_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">length</span>(subset_rf_prepared))</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>successful_fits_rf <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Initialisation de successful_fits_rf</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle sur chaque jeu imputé manuellement</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(subset_rf_prepared)) {</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    fit_rf_list[[i]] <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_with_ctrl, <span class="at">data =</span> subset_rf_prepared[[i]], <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Modèle RF"</span>, i, <span class="st">"ajusté avec succès</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Erreur lors de l'ajustement du modèle RF pour le jeu"</span>, i, <span class="st">":"</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>    fit_rf_list[[i]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modèle RF 1 ajusté avec succès
Modèle RF 2 ajusté avec succès
Modèle RF 3 ajusté avec succès
Modèle RF 4 ajusté avec succès
Modèle RF 5 ajusté avec succès
Modèle RF 6 ajusté avec succès
Modèle RF 7 ajusté avec succès
Modèle RF 8 ajusté avec succès
Modèle RF 9 ajusté avec succès
Modèle RF 10 ajusté avec succès</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier combien de modèles ont été ajustés avec succès</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>successful_fits_rf <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">sapply</span>(fit_rf_list, is.null))</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre de modèles RF ajustés avec succès:"</span>, successful_fits_rf, <span class="st">"sur"</span>, <span class="fu">length</span>(subset_rf_prepared), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre de modèles RF ajustés avec succès: 10 sur 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si aucun modèle n'a été ajusté avec succès, arrêter ici</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (successful_fits_rf <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Aucun modèle RF n'a pu être ajusté. Vérifiez les données et le modèle.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extraction manuelle des paramètres pour le pooling</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  param_list_rf <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, successful_fits_rf)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  successful_idx_rf <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">sapply</span>(fit_rf_list, is.null))</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>successful_fits_rf) {</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> successful_idx_rf[i]</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extraire les paramètres standardisés</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">&lt;-</span> <span class="fu">standardizedSolution</span>(fit_rf_list[[idx]])</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrer pour ne garder que les chemins de régression et effets indirects</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">&lt;-</span> params[params<span class="sc">$</span>op <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"~"</span>, <span class="st">":="</span>), ]</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Créer un dataframe avec les colonnes nécessaires pour le pooling</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>    param_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> <span class="fu">paste</span>(params<span class="sc">$</span>lhs, params<span class="sc">$</span>op, params<span class="sc">$</span>rhs),</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> params<span class="sc">$</span>est.std,</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> params<span class="sc">$</span>se,</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> params<span class="sc">$</span>z,</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> params<span class="sc">$</span>pvalue</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>    param_list_rf[[i]] <span class="ot">&lt;-</span> param_df</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vérifier que tous les param_list ont le même nombre de lignes</span></span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>  nrows <span class="ot">&lt;-</span> <span class="fu">sapply</span>(param_list_rf, nrow)</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(nrows)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Attention: Les modèles RF n'ont pas tous le même nombre de paramètres.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Utiliser le nombre minimum de paramètres communs</span></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>    min_nrow <span class="ot">&lt;-</span> <span class="fu">min</span>(nrows)</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>    param_list_rf <span class="ot">&lt;-</span> <span class="fu">lapply</span>(param_list_rf, <span class="cf">function</span>(x) x[<span class="dv">1</span><span class="sc">:</span>min_nrow, ])</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pooling manuel des résultats</span></span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>  pooled_results_rf <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">nrow</span>(param_list_rf[[<span class="dv">1</span>]]))</span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(param_list_rf[[<span class="dv">1</span>]])) {</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extraire les estimations et erreurs standard pour ce paramètre</span></span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a>    estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(param_list_rf, <span class="cf">function</span>(x) x<span class="sc">$</span>estimate[j])</span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a>    std.errors <span class="ot">&lt;-</span> <span class="fu">sapply</span>(param_list_rf, <span class="cf">function</span>(x) x<span class="sc">$</span>std.error[j])</span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la moyenne des estimations</span></span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a>    q_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(estimates)</span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la variance intra-imputation</span></span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a>    u_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(std.errors<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la variance inter-imputation</span></span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">var</span>(estimates)</span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-54"><a href="#cb107-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la variance totale selon les règles de Rubin</span></span>
<span id="cb107-55"><a href="#cb107-55" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> u_bar <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>successful_fits_rf) <span class="sc">*</span> b</span>
<span id="cb107-56"><a href="#cb107-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-57"><a href="#cb107-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer les degrés de liberté</span></span>
<span id="cb107-58"><a href="#cb107-58" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> (successful_fits_rf <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> u_bar <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>successful_fits_rf) <span class="sc">*</span> b))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb107-59"><a href="#cb107-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-60"><a href="#cb107-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculer la statistique t et la p-value</span></span>
<span id="cb107-61"><a href="#cb107-61" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="ot">&lt;-</span> q_bar <span class="sc">/</span> <span class="fu">sqrt</span>(t)</span>
<span id="cb107-62"><a href="#cb107-62" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat), <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-63"><a href="#cb107-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-64"><a href="#cb107-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stocker les résultats</span></span>
<span id="cb107-65"><a href="#cb107-65" aria-hidden="true" tabindex="-1"></a>    pooled_results_rf[[j]] <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb107-66"><a href="#cb107-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> param_list_rf[[<span class="dv">1</span>]]<span class="sc">$</span>term[j],</span>
<span id="cb107-67"><a href="#cb107-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> q_bar,</span>
<span id="cb107-68"><a href="#cb107-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="fu">sqrt</span>(t),</span>
<span id="cb107-69"><a href="#cb107-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> t_stat,</span>
<span id="cb107-70"><a href="#cb107-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> p_value,</span>
<span id="cb107-71"><a href="#cb107-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">df =</span> df</span>
<span id="cb107-72"><a href="#cb107-72" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb107-73"><a href="#cb107-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-74"><a href="#cb107-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-75"><a href="#cb107-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convertir en dataframe</span></span>
<span id="cb107-76"><a href="#cb107-76" aria-hidden="true" tabindex="-1"></a>  pooled_df_rf <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(pooled_results_rf, <span class="cf">function</span>(x) {</span>
<span id="cb107-77"><a href="#cb107-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb107-78"><a href="#cb107-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> x[<span class="st">"term"</span>],</span>
<span id="cb107-79"><a href="#cb107-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> <span class="fu">as.numeric</span>(x[<span class="st">"estimate"</span>]),</span>
<span id="cb107-80"><a href="#cb107-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="fu">as.numeric</span>(x[<span class="st">"std.error"</span>]),</span>
<span id="cb107-81"><a href="#cb107-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="fu">as.numeric</span>(x[<span class="st">"statistic"</span>]),</span>
<span id="cb107-82"><a href="#cb107-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> <span class="fu">as.numeric</span>(x[<span class="st">"p.value"</span>]),</span>
<span id="cb107-83"><a href="#cb107-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">df =</span> <span class="fu">as.numeric</span>(x[<span class="st">"df"</span>])</span>
<span id="cb107-84"><a href="#cb107-84" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb107-85"><a href="#cb107-85" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb107-86"><a href="#cb107-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-87"><a href="#cb107-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Affichage des résultats poolés</span></span>
<span id="cb107-88"><a href="#cb107-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== RÉSULTATS POOLÉS (RF) ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-89"><a href="#cb107-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-90"><a href="#cb107-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Chemins de régression directs</span></span>
<span id="cb107-91"><a href="#cb107-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Régressions directes:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-92"><a href="#cb107-92" aria-hidden="true" tabindex="-1"></a>  direct_paths_rf <span class="ot">&lt;-</span> pooled_df_rf[<span class="fu">grepl</span>(<span class="st">" ~ "</span>, pooled_df_rf<span class="sc">$</span>term), ]</span>
<span id="cb107-93"><a href="#cb107-93" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(direct_paths_rf)) {</span>
<span id="cb107-94"><a href="#cb107-94" aria-hidden="true" tabindex="-1"></a>    signif <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb107-95"><a href="#cb107-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (direct_paths_rf<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.001</span>) signif <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb107-96"><a href="#cb107-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (direct_paths_rf<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.01</span>) signif <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb107-97"><a href="#cb107-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (direct_paths_rf<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.05</span>) signif <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb107-98"><a href="#cb107-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (direct_paths_rf<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.1</span>) signif <span class="ot">&lt;-</span> <span class="st">"."</span></span>
<span id="cb107-99"><a href="#cb107-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-100"><a href="#cb107-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%s (β=%.3f, p=%.4f) %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb107-101"><a href="#cb107-101" aria-hidden="true" tabindex="-1"></a>                direct_paths_rf<span class="sc">$</span>term[i],</span>
<span id="cb107-102"><a href="#cb107-102" aria-hidden="true" tabindex="-1"></a>                direct_paths_rf<span class="sc">$</span>estimate[i], </span>
<span id="cb107-103"><a href="#cb107-103" aria-hidden="true" tabindex="-1"></a>                direct_paths_rf<span class="sc">$</span>p.value[i],</span>
<span id="cb107-104"><a href="#cb107-104" aria-hidden="true" tabindex="-1"></a>                signif))</span>
<span id="cb107-105"><a href="#cb107-105" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-106"><a href="#cb107-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-107"><a href="#cb107-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Effets indirects</span></span>
<span id="cb107-108"><a href="#cb107-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effets indirects et totaux:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-109"><a href="#cb107-109" aria-hidden="true" tabindex="-1"></a>  indirect_paths_rf <span class="ot">&lt;-</span> pooled_df_rf[<span class="fu">grepl</span>(<span class="st">" := "</span>, pooled_df_rf<span class="sc">$</span>term), ]</span>
<span id="cb107-110"><a href="#cb107-110" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(indirect_paths_rf)) {</span>
<span id="cb107-111"><a href="#cb107-111" aria-hidden="true" tabindex="-1"></a>    signif <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb107-112"><a href="#cb107-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (indirect_paths_rf<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.001</span>) signif <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb107-113"><a href="#cb107-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (indirect_paths_rf<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.01</span>) signif <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb107-114"><a href="#cb107-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (indirect_paths_rf<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.05</span>) signif <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb107-115"><a href="#cb107-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (indirect_paths_rf<span class="sc">$</span>p.value[i] <span class="sc">&lt;</span> <span class="fl">0.1</span>) signif <span class="ot">&lt;-</span> <span class="st">"."</span></span>
<span id="cb107-116"><a href="#cb107-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-117"><a href="#cb107-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%s (β=%.3f, p=%.4f) %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb107-118"><a href="#cb107-118" aria-hidden="true" tabindex="-1"></a>                indirect_paths_rf<span class="sc">$</span>term[i],</span>
<span id="cb107-119"><a href="#cb107-119" aria-hidden="true" tabindex="-1"></a>                indirect_paths_rf<span class="sc">$</span>estimate[i], </span>
<span id="cb107-120"><a href="#cb107-120" aria-hidden="true" tabindex="-1"></a>                indirect_paths_rf<span class="sc">$</span>p.value[i],</span>
<span id="cb107-121"><a href="#cb107-121" aria-hidden="true" tabindex="-1"></a>                signif))</span>
<span id="cb107-122"><a href="#cb107-122" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-123"><a href="#cb107-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-124"><a href="#cb107-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour RF - Calcul et affichage des indices d'ajustement moyens</span></span>
<span id="cb107-125"><a href="#cb107-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== INDICES D'AJUSTEMENT MOYENS (RF) ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-126"><a href="#cb107-126" aria-hidden="true" tabindex="-1"></a>  fit_indices_rf <span class="ot">&lt;-</span> <span class="fu">lapply</span>(fit_rf_list[<span class="sc">!</span><span class="fu">sapply</span>(fit_rf_list, is.null)], fitMeasures)</span>
<span id="cb107-127"><a href="#cb107-127" aria-hidden="true" tabindex="-1"></a>  fit_indices_rf_mean <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, fit_indices_rf) <span class="sc">/</span> <span class="fu">length</span>(fit_indices_rf)</span>
<span id="cb107-128"><a href="#cb107-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-129"><a href="#cb107-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Chi² moyen = %.3f (df=%.0f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb107-130"><a href="#cb107-130" aria-hidden="true" tabindex="-1"></a>              fit_indices_rf_mean[<span class="st">"chisq"</span>], </span>
<span id="cb107-131"><a href="#cb107-131" aria-hidden="true" tabindex="-1"></a>              fit_indices_rf_mean[<span class="st">"df"</span>]))</span>
<span id="cb107-132"><a href="#cb107-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"CFI moyen = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_rf_mean[<span class="st">"cfi"</span>]))</span>
<span id="cb107-133"><a href="#cb107-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"TLI moyen = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_rf_mean[<span class="st">"tli"</span>]))</span>
<span id="cb107-134"><a href="#cb107-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"RMSEA moyen = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_rf_mean[<span class="st">"rmsea"</span>]))</span>
<span id="cb107-135"><a href="#cb107-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SRMR moyen = %.3f</span><span class="sc">\n</span><span class="st">"</span>, fit_indices_rf_mean[<span class="st">"srmr"</span>]))</span>
<span id="cb107-136"><a href="#cb107-136" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== RÉSULTATS POOLÉS (RF) ===

Régressions directes:
Image ~ CredME (β=0.481, p=0.0000) ***
Image ~ Note (β=0.336, p=0.0000) ***
Image ~ FAM (β=-0.000, p=0.9942) 
Image ~ age_num (β=0.088, p=0.0021) **
CredME ~ CredE (β=0.505, p=0.0000) ***
CredME ~ CredGD (β=0.272, p=0.0000) ***
CredE ~ Cong (β=0.250, p=0.0000) ***
CredE ~ Source (β=0.353, p=0.0000) ***
CredGD ~ Cong (β=0.228, p=0.0003) ***
CredGD ~ Note (β=0.098, p=0.1332) 
Cong ~ Note (β=0.617, p=0.0000) ***
Cong ~ Source (β=0.025, p=0.5244) 

Effets indirects et totaux:
ind1 := e2*c1*a1*b1 (β=0.002, p=0.5389) 
ind2 := e2*d1*a2*b1 (β=0.001, p=0.5458) 
ind3 := c2*a1*b1 (β=0.086, p=0.0000) ***
ind4 := e1*d1*a2*b1 (β=0.018, p=0.0047) **
ind5 := e1*c1*a1*b1 (β=0.037, p=0.0000) ***
ind6 := d2*a2*b1 (β=0.013, p=0.1414) 
tot_ind := ind1+ind2+ind3+ind4+ind5+ind6 (β=0.157, p=0.0000) ***
tot_effect := tot_ind+b2 (β=0.493, p=0.0000) ***

=== INDICES D'AJUSTEMENT MOYENS (RF) ===
Chi² moyen = 95.202 (df=18)
CFI moyen = 0.907
TLI moyen = 0.845
RMSEA moyen = 0.103
SRMR moyen = 0.069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Légende des niveaux de significativité</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Légende des niveaux de significativité:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Légende des niveaux de significativité:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"*** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>*** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</code></pre>
</div>
</div>
</section>
<section id="analyse-des-résultats---imputation-rf" class="level2">
<h2 class="anchored" data-anchor-id="analyse-des-résultats---imputation-rf">Analyse des résultats - Imputation RF</h2>
<p>L’analyse utilisant l’imputation par Random Forest (RF) présente des caractéristiques intermédiaires entre l’analyse sur cas complets et l’imputation PMM, tout en maintenant une forte cohérence des effets.</p>
<section id="ajustement-du-modèle" class="level3">
<h3 class="anchored" data-anchor-id="ajustement-du-modèle">Ajustement du modèle</h3>
<p>Le modèle RF présente un ajustement satisfaisant : - Le CFI moyen (0.907) dépasse le seuil recommandé de 0.90 - Le TLI moyen (0.845) s’améliore par rapport au modèle noDM mais reste inférieur au seuil de 0.90 - Le RMSEA moyen (0.103) reste élevé, proche de celui du modèle noDM - Le SRMR moyen (0.069) est bien dans la zone d’acceptabilité</p>
<p>L’ajustement est meilleur que celui des données complètes mais légèrement moins bon que celui de l’imputation PMM.</p>
</section>
<section id="comparaison-des-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="comparaison-des-coefficients">Comparaison des coefficients</h3>
<p>La cohérence entre les trois approches est robuste : - Le coefficient CredME → Image (0.481) est quasiment identique à celui obtenu avec PMM (0.482) - L’effet Note → Image (0.336) est également identique entre RF et PMM - La relation CredE → CredME est légèrement plus forte avec RF (0.514 vs 0.481), tandis que CredGD → CredME est légèrement plus faible (0.272 vs 0.298) - Les effets indirects conservent leur importance relative à travers les trois méthodes</p>
</section>
</section>
<section id="synthèse-comparative-et-analyse-de-sensibilité" class="level2">
<h2 class="anchored" data-anchor-id="synthèse-comparative-et-analyse-de-sensibilité">Synthèse comparative et analyse de sensibilité</h2>
<p>La comparaison des trois méthodes (cas complets, PMM, RF) constitue une analyse de sensibilité robuste qui renforce considérablement la fiabilité de nos résultats. Les points essentiels à retenir sont :</p>
<ol type="1">
<li><p><strong>Stabilité des effets principaux</strong> : Les relations clés (Note → Image, CredME → Image, Source → CredE) sont constantes à travers les trois approches, avec des variations minimales dans les coefficients standardisés.</p></li>
<li><p><strong>Ajustement amélioré avec imputation</strong> : Les deux méthodes d’imputation, particulièrement PMM, améliorent l’ajustement du modèle, suggérant que le traitement des données manquantes renforce la validité de nos conclusions.</p></li>
<li><p><strong>Convergence des médiations</strong> : Les chemins de médiation significatifs restent cohérents à travers les trois analyses, confirmant le rôle crucial de :</p>
<ul>
<li>L’effet indirect de la source sur l’image via la crédibilité (Source → CredE → CredME → Image)</li>
<li>L’effet indirect de la note via la congruence et les mécanismes de crédibilité</li>
</ul></li>
</ol>
<p>Cette triple validation confirme la robustesse de notre modèle conceptuel, démontrant que les relations identifiées ne sont pas sensibles à la méthode de traitement des données manquantes. La concordance entre les trois approches suggère que nos conclusions reflètent des effets réels plutôt que des artefacts méthodologiques.</p>
<p>Une analyse de sensibilité supplémentaire ne semble pas nécessaire, car la comparaison entre ces trois méthodes distinctes constitue déjà une validation croisée solide de nos résultats. La robustesse de ces résultats est confirmée par leur stabilité à travers trois méthodes d’analyse différentes (données complètes, PMM, RF), renforçant ainsi la validité de nos conclusions.</p>
</section>
</section>
<section id="validation-des-hypothèses" class="level1">
<h1>5. Validation des hypothèses</h1>
<section id="synthèse-des-résultats-et-validation-des-hypothèses" class="level2">
<h2 class="anchored" data-anchor-id="synthèse-des-résultats-et-validation-des-hypothèses">Synthèse des résultats et validation des hypothèses</h2>
<p>Sur la base des analyses SEM réalisées, nous pouvons valider ou infirmer nos hypothèses de recherche :</p>
<section id="relations-directes-1" class="level3">
<h3 class="anchored" data-anchor-id="relations-directes-1">Relations directes</h3>
<p><strong>H1</strong>: La note Glassdoor de l’employeur (Note) influence positivement l’image employeur (Image). - ✓ VALIDÉE - Effet direct significatif (β = 0.336, p &lt; 0.001) dans les deux méthodes d’imputation - Relation forte et stable</p>
<p><strong>H2</strong>: La note Glassdoor de l’employeur (Note) influence positivement la congruence des signaux (Cong). - ✓ VALIDÉE - Effet direct fort et significatif (β = 0.617, p &lt; 0.001) dans les deux méthodes - Relation très forte et stable</p>
<p><strong>H3</strong>: La source de l’enquête (Source) influence positivement la congruence des signaux (Cong). - ✗ NON VALIDÉE - Effet non significatif (β = 0.025, p = 0.524) dans les deux méthodes - Relation faible et non significative</p>
<p><strong>H4</strong>: La note Glassdoor de l’employeur (Note) influence la crédibilité perçue de la note Glassdoor de l’employeur (CredGD). - ✗ NON VALIDÉE - Effet direct non significatif (β = 0.098, p = 0.133) dans les deux méthodes - L’influence passe principalement par la congruence</p>
<p><strong>H5</strong>: La source de l’enquête (Source) influence la crédibilité perçue de l’enquête (CredE). - ✓ VALIDÉE - Effet direct significatif (β ≈ 0.35, p &lt; 0.001) dans les deux méthodes - Relation stable et forte</p>
<p><strong>H6</strong>: La congruence des signaux (Cong) influence positivement la crédibilité des signaux. - ✓ VALIDÉE - H6a: Effet significatif sur CredE (β ≈ 0.25, p &lt; 0.001) dans les deux méthodes - H6b: Effet significatif sur CredGD (β = 0.228, p &lt; 0.001) dans les deux méthodes</p>
<p><strong>H7</strong>: La crédibilité de la marque employeur (CredME) influence positivement l’image employeur (Image). - ✓ VALIDÉE - Effet direct fort (β ≈ 0.48, p &lt; 0.001) dans les deux méthodes - Impact le plus important sur l’image dans le modèle</p>
<p><strong>H8</strong>: La crédibilité des signaux influence la crédibilité de la marque employeur (CredME). - ✓ VALIDÉE - H8a: CredGD → CredME significatif (β ≈ 0.27-0.30, p &lt; 0.001) dans les deux méthodes - H8b: CredE → CredME significatif (β ≈ 0.49-0.51, p &lt; 0.001) dans les deux méthodes</p>
</section>
<section id="relations-de-médiation" class="level3">
<h3 class="anchored" data-anchor-id="relations-de-médiation">Relations de médiation</h3>
<p><strong>H9</strong>: Les effets de la source de l’enquête sur l’image employeur sont médiatisés par une chaîne de médiation impliquant la congruence des signaux, la crédibilité des signaux et la crédibilité de la marque employeur. - ✗ NON VALIDÉE - H9a: Chaîne Source → Cong → CredGD → CredME → Image non significative (ind2 ≈ 0.001, p &gt; 0.54) - H9b: Chaîne Source → Cong → CredE → CredME → Image non significative (ind1 ≈ 0.001-0.002, p &gt; 0.53) - L’absence d’effet significatif de Source sur Cong empêche ces chaînes de médiation d’être significatives</p>
<p><strong>H10</strong>: Les effets de la source de l’enquête sur l’image employeur sont médiatisés par une chaîne de médiation impliquant la crédibilité de l’enquête et la crédibilité de la marque employeur. - ✓ VALIDÉE - Effet indirect significatif Source → CredE → CredME → Image (ind3 ≈ 0.085, p &lt; 0.001) dans les deux méthodes - Représente le principal chemin par lequel la source influence l’image</p>
<p><strong>H11</strong>: Les effets de la note Glassdoor sur l’image employeur sont médiatisés par une chaîne de médiation impliquant la crédibilité de la note Glassdoor et la crédibilité de la marque employeur. - ✗ NON VALIDÉE - Effet indirect Note → CredGD → CredME → Image non significatif (ind6 ≈ 0.013-0.014, p ≈ 0.14) - L’absence d’effet significatif de Note sur CredGD empêche cette chaîne de médiation d’être significative</p>
<p><strong>H12</strong>: Les effets de la note sur l’image employeur sont médiatisés par une chaîne de médiation impliquant la congruence des signaux, la crédibilité des signaux et la crédibilité de la marque employeur. - ✓ VALIDÉE - H12a: Chaîne Note → Cong → CredGD → CredME → Image significative (ind4 ≈ 0.019, p &lt; 0.01) - H12b: Chaîne Note → Cong → CredE → CredME → Image significative (ind5 ≈ 0.037, p &lt; 0.001) - Effet indirect total significatif (tot_ind = 0.157, p &lt; 0.001)</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Les analyses SEM basées sur les méthodes d’imputation PMM et RF révèlent un support empirique solide pour la majorité de nos hypothèses, démontrant la complexité des mécanismes par lesquels la note d’employeur et sa source influencent l’image de l’entreprise. Nos résultats mettent en évidence trois points majeurs :</p>
<ol type="1">
<li><strong>Le rôle central de la crédibilité dans la formation de l’image employeur</strong> :
<ul>
<li>La crédibilité de la marque employeur comme déterminant principal de l’image</li>
<li>L’influence significative des différentes formes de crédibilité (CredE, CredGD, CredME)</li>
</ul></li>
<li><strong>L’importance des mécanismes de médiation</strong> :
<ul>
<li>La congruence des signaux comme médiateur clé pour les effets de la note</li>
<li>La crédibilité de l’enquête comme médiateur principal pour les effets de la source</li>
<li>Les chaînes de médiation multiples impliquant la crédibilité</li>
</ul></li>
<li><strong>La différenciation des effets selon la source et la note</strong> :
<ul>
<li>Impact direct et indirect de la note sur l’image</li>
<li>Absence d’effet de la source sur la congruence, contrairement à l’hypothèse initiale</li>
<li>Importance de la congruence dans la transmission des effets de la note, mais pas de la source</li>
</ul></li>
</ol>
<p>Ces résultats sont particulièrement robustes car ils sont cohérents entre les deux méthodes d’imputation (PMM et RF), ce qui renforce considérablement la fiabilité de nos conclusions.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>